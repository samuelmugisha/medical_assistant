<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jupyter Notebook ‚Äî generated with runcell</title>
    <meta name="description" content="Exported with runcell ‚Äî convert .ipynb notebooks to HTML or PDF anytime at runcell.dev." />
    <meta name="generator" content="runcell" />
    <style>
        :root {
            --jp-code-font-family: 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace;
            --jp-content-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            --jp-cell-prompt-width: 64px;
            --jp-input-prompt-color: #307fc1;
            --jp-output-prompt-color: #bf5b3d;
            --jp-cell-input-bg: #f7f7f7;
            --jp-layout-color0: #ffffff;
            --jp-layout-color1: #f7f7f7;
            --jp-border-color1: #e0e0e0;
            --jp-content-font-color0: #000000;
            --jp-content-font-color1: #333333;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--jp-content-font-family);
            font-size: 14px;
            line-height: 1.5;
            color: var(--jp-content-font-color0);
            background-color: var(--jp-layout-color0);
            margin: 0;
            padding: 0;
        }

        .notebook-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Cell structure */
        .cell {
            display: flex;
            flex-direction: row;
            margin-bottom: 12px;
            position: relative;
        }

        .cell-prompt {
            min-width: var(--jp-cell-prompt-width);
            width: var(--jp-cell-prompt-width);
            font-family: var(--jp-code-font-family);
            font-size: 12px;
            padding: 10px 8px 10px 0;
            text-align: right;
            flex-shrink: 0;
            user-select: none;
        }

        .cell-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        /* Input prompt styling - Jupyter blue */
        .input-prompt {
            color: var(--jp-input-prompt-color);
            font-weight: bold;
        }

        /* Output prompt styling - Jupyter red/orange */
        .output-prompt {
            color: var(--jp-output-prompt-color);
            font-weight: bold;
        }

        /* Code cell input area */
        .input-area {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            overflow-x: auto;
        }

        .input-area pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Output area */
        .output-area {
            margin-top: 0;
        }

        .output-wrapper {
            display: flex;
            flex-direction: row;
            margin-top: 4px;
        }

        .output-content {
            flex: 1;
            min-width: 0;
            padding: 8px 0;
        }

        .output-content pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Stream output (stdout/stderr) */
        .output-stream {
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-stderr {
            background-color: #fdd;
            padding: 8px 12px;
            border-radius: 2px;
        }

        /* Execute result / display data */
        .output-result {
            padding: 4px 0;
        }

        .output-result pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
        }

        /* Image output */
        .output-image {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* HTML output (DataFrames, etc.) */
        .output-html {
            overflow-x: auto;
        }

        .output-html table {
            border-collapse: collapse;
            font-size: 13px;
            font-family: var(--jp-content-font-family);
        }

        .output-html table th,
        .output-html table td {
            border: 1px solid #ddd;
            padding: 6px 10px;
            text-align: left;
        }

        .output-html table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }

        .output-html table tr:nth-child(even) {
            background-color: #fafafa;
        }

        /* Error output */
        .output-error {
            background-color: #fff0f0;
            padding: 8px 12px;
            border-radius: 2px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Markdown cell styling */
        .markdown-cell {
            padding: 10px 0;
        }

        .markdown-cell h1 {
            font-size: 2em;
            font-weight: 600;
            margin: 0.67em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h2 {
            font-size: 1.5em;
            font-weight: 600;
            margin: 0.83em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h3 {
            font-size: 1.25em;
            font-weight: 600;
            margin: 1em 0;
        }

        .markdown-cell h4 {
            font-size: 1em;
            font-weight: 600;
            margin: 1.33em 0;
        }

        .markdown-cell h5 {
            font-size: 0.875em;
            font-weight: 600;
            margin: 1.67em 0;
        }

        .markdown-cell h6 {
            font-size: 0.85em;
            font-weight: 600;
            margin: 2.33em 0;
            color: #6a737d;
        }

        .markdown-cell p {
            margin: 0 0 16px 0;
            line-height: 1.6;
        }

        .markdown-cell code {
            font-family: var(--jp-code-font-family);
            font-size: 85%;
            background-color: rgba(27, 31, 35, 0.05);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        .markdown-cell pre {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 3px;
            padding: 16px;
            overflow-x: auto;
            font-size: 85%;
            line-height: 1.45;
        }

        .markdown-cell pre code {
            background-color: transparent;
            padding: 0;
            border-radius: 0;
            font-size: 100%;
        }

        .markdown-cell blockquote {
            margin: 0 0 16px 0;
            padding: 0 1em;
            color: #6a737d;
            border-left: 4px solid #dfe2e5;
        }

        .markdown-cell ul,
        .markdown-cell ol {
            margin: 0 0 16px 0;
            padding-left: 2em;
        }

        .markdown-cell li {
            margin: 0.25em 0;
        }

        .markdown-cell a {
            color: #0366d6;
            text-decoration: none;
        }

        .markdown-cell a:hover {
            text-decoration: underline;
        }

        .markdown-cell hr {
            border: 0;
            border-top: 1px solid var(--jp-border-color1);
            margin: 24px 0;
        }

        .markdown-cell img {
            max-width: 100%;
            height: auto;
        }

        .markdown-cell table {
            border-collapse: collapse;
            margin: 0 0 16px 0;
        }

        .markdown-cell table th,
        .markdown-cell table td {
            border: 1px solid #dfe2e5;
            padding: 6px 13px;
        }

        .markdown-cell table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }

        .markdown-cell table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }

        /* Raw cell styling */
        .raw-cell {
            background-color: var(--jp-layout-color1);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Empty prompt placeholder */
        .prompt-empty {
            color: transparent;
        }

        .export-footer {
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--jp-border-color1);
            color: #555;
            font-size: 13px;
            text-align: center;
        }

        .export-footer a {
            color: #0366d6;
            text-decoration: none;
        }

        .export-footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="notebook-container">
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><center><p float="center"><br><br></p></center><br><br><center><font size=6>Medical Assistant</center></font></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Problem Statement</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Business Context</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The healthcare industry is rapidly evolving, with professionals facing increasing challenges in managing vast volumes of medical data while delivering accurate and timely diagnoses. The need for quick access to comprehensive, reliable, and up-to-date medical knowledge is critical for improving patient outcomes and ensuring informed decision-making in a fast-paced environment.<br><br>Healthcare professionals often encounter information overload, struggling to sift through extensive research and data to create accurate diagnoses and treatment plans. This challenge is amplified by the need for efficiency, particularly in emergencies, where time-sensitive decisions are vital. Furthermore, access to trusted, current medical information from renowned manuals and research papers is essential for maintaining high standards of care.<br><br>To address these challenges, healthcare centers can focus on integrating systems that streamline access to medical knowledge, provide tools to support quick decision-making, and enhance efficiency. Leveraging centralized knowledge platforms and ensuring healthcare providers have continuous access to reliable resources can significantly improve patient care and operational effectiveness.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Common Questions to Answer</strong><br><br><strong>1. Diagnostic Assistance</strong>: "What are the common symptoms and treatments for pulmonary embolism?"<br><br><strong>2. Drug Information</strong>: "Can you provide the trade names of medications used for treating hypertension?"<br><br><strong>3. Treatment Plans</strong>: "What are the first-line options and alternatives for managing rheumatoid arthritis?"<br><br><strong>4. Specialty Knowledge</strong>: "What are the diagnostic steps for suspected endocrine disorders?"<br><br><strong>5. Critical Care Protocols</strong>: "What is the protocol for managing sepsis in a critical care unit?"</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Objective</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">As an AI specialist, your task is to develop a RAG-based AI solution using renowned medical manuals to address healthcare challenges. The objective is to <strong>understand</strong> issues like information overload, <strong>apply</strong> AI techniques to streamline decision-making, <strong>analyze</strong> its impact on diagnostics and patient outcomes, <strong>evaluate</strong> its potential to standardize care practices, and <strong>create</strong> a functional prototype demonstrating its feasibility and effectiveness.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Data Description</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The <strong>Merck Manuals</strong> are medical references published by the American pharmaceutical company Merck & Co., that cover a wide range of medical topics, including disorders, tests, diagnoses, and drugs. The manuals have been published since 1899, when Merck & Co. was still a subsidiary of the German company Merck.<br><br>The manual is provided as a PDF with over 4,000 pages divided into 23 sections.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Installing and Importing Necessary Libraries and Dependencies</h2></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [1]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Installation for GPU llama-cpp-python
# uncomment and run the following code in case GPU is being used
!CMAKE_ARGS="-DLLAMA_CUBLAS=on" FORCE_CMAKE=1 pip install llama-cpp-python==0.1.85 --quiet --no-warn-script-location --force-reinstall --no-cache-dir -q

# Installation for CPU llama-cpp-python
# uncomment and run the following code in case GPU is not being used
# !CMAKE_ARGS="-DLLAMA_CUBLAS=off" FORCE_CMAKE=1 pip install llama-cpp-python==0.1.85 --force-reinstall --no-cache-dir -q</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">[?25l     [90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m0.0/1.8 MB[0m [31m?[0m eta [36m-:--:--[0m[2K     [91m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m[91m‚ï∏[0m[90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m0.7/1.8 MB[0m [31m22.3 MB/s[0m eta [36m0:00:01[0m[2K     [90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m1.8/1.8 MB[0m [31m40.6 MB/s[0m eta [36m0:00:00[0m
[?25h  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Preparing metadata (pyproject.toml) ... [?25l[?25hdone
[2K   [90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m45.5/45.5 kB[0m [31m321.1 MB/s[0m eta [36m0:00:00[0m
[2K   [90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m16.4/16.4 MB[0m [31m310.3 MB/s[0m eta [36m0:00:00[0m
[2K   [90m‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ[0m [32m44.6/44.6 kB[0m [31m305.6 MB/s[0m eta [36m0:00:00[0m
[?25h  Building wheel for llama-cpp-python (pyproject.toml) ... [?25l[?25hdone
[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
opencv-python-headless 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 2.4.1 which is incompatible.
tensorflow 2.19.0 requires numpy&lt;2.2.0,&gt;=1.26.0, but you have numpy 2.4.1 which is incompatible.
opencv-contrib-python 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 2.4.1 which is incompatible.
numba 0.60.0 requires numpy&lt;2.1,&gt;=1.22, but you have numpy 2.4.1 which is incompatible.
opencv-python 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 2.4.1 which is incompatible.[0m[31m
[0m</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Note</strong>:<br>- After running the above cell, kindly restart the runtime (for Google Colab) or notebook kernel (for Jupyter Notebook), and run all cells sequentially from the next cell.<br>- On executing the above line of code, you might see a warning regarding package dependencies. This error message can be ignored as the above code ensures that all necessary libraries and their dependencies are maintained to successfully execute the code in <strong><em>this notebook</strong></em>.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [14]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># For installing the libraries &amp; downloading models from HF Hub
!pip install numpy==1.24.4 --quiet --no-warn-script-location --force-reinstall --no-cache-dir
!pip install huggingface_hub==0.23.2 pandas==1.5.3 tiktoken==0.6.0 pymupdf==1.25.1 langchain==0.1.1 langchain-community==0.0.13 chromadb==0.4.22 sentence-transformers==2.3.1 --quiet --no-warn-script-location --force-reinstall --no-cache-dir</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">  Installing build dependencies ... [?25l[?25hdone
  [1;31merror[0m: [1msubprocess-exited-with-error[0m
  
  [31m√ó[0m [32mGetting requirements to build wheel[0m did not run successfully.
  [31m‚îÇ[0m exit code: [1;36m1[0m
  [31m‚ï∞‚îÄ&gt;[0m No available output.
  
  [1;35mnote[0m: This error originates from a subprocess, and is likely not a problem with pip.
  Getting requirements to build wheel ... [?25l[?25herror
[31mERROR: Failed to build 'numpy' when getting requirements to build wheel[0m[31m
[0m  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Preparing metadata (pyproject.toml) ... [?25l[?25hdone
  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Preparing metadata (pyproject.toml) ... [?25l[?25hdone
  Installing build dependencies ... [?25l[?25hdone
  Getting requirements to build wheel ... [?25l[?25hdone
  Preparing metadata (pyproject.toml) ... [?25l[?25hdone
  Building wheel for pandas (pyproject.toml) ... [?25l[?25hdone
  Building wheel for chroma-hnswlib (pyproject.toml) ... [?25l[?25hdone
  Building wheel for pypika (pyproject.toml) ... [?25l[?25hdone
[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
ipython 7.34.0 requires jedi&gt;=0.16, which is not installed.
google-colab 1.0.0 requires google-auth==2.43.0, but you have google-auth 2.47.0 which is incompatible.
google-colab 1.0.0 requires pandas==2.2.2, but you have pandas 1.5.3 which is incompatible.
google-colab 1.0.0 requires requests==2.32.4, but you have requests 2.32.5 which is incompatible.
google-genai 1.55.0 requires websockets&lt;15.1.0,&gt;=13.0.0, but you have websockets 16.0 which is incompatible.
opencv-python-headless 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 1.26.4 which is incompatible.
google-adk 1.21.0 requires fastapi&lt;0.124.0,&gt;=0.115.0, but you have fastapi 0.128.0 which is incompatible.
google-adk 1.21.0 requires opentelemetry-api&lt;=1.37.0,&gt;=1.37.0, but you have opentelemetry-api 1.39.1 which is incompatible.
google-adk 1.21.0 requires opentelemetry-sdk&lt;=1.37.0,&gt;=1.37.0, but you have opentelemetry-sdk 1.39.1 which is incompatible.
google-adk 1.21.0 requires tenacity&lt;10.0.0,&gt;=9.0.0, but you have tenacity 8.5.0 which is incompatible.
google-adk 1.21.0 requires websockets&lt;16.0.0,&gt;=15.0.1, but you have websockets 16.0 which is incompatible.
xarray 2025.12.0 requires packaging&gt;=24.1, but you have packaging 23.2 which is incompatible.
xarray 2025.12.0 requires pandas&gt;=2.2, but you have pandas 1.5.3 which is incompatible.
datasets 4.0.0 requires fsspec[http]&lt;=2025.3.0,&gt;=2023.1.0, but you have fsspec 2026.1.0 which is incompatible.
datasets 4.0.0 requires huggingface-hub&gt;=0.24.0, but you have huggingface-hub 0.23.2 which is incompatible.
diffusers 0.36.0 requires huggingface-hub&lt;2.0,&gt;=0.34.0, but you have huggingface-hub 0.23.2 which is incompatible.
tensorflow 2.19.0 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;6.0.0dev,&gt;=3.20.3, but you have protobuf 6.33.3 which is incompatible.
jax 0.7.2 requires numpy&gt;=2.0, but you have numpy 1.26.4 which is incompatible.
plotnine 0.14.5 requires pandas&gt;=2.2.0, but you have pandas 1.5.3 which is incompatible.
gradio 5.50.0 requires huggingface-hub&lt;2.0,&gt;=0.33.5, but you have huggingface-hub 0.23.2 which is incompatible.
gradio 5.50.0 requires pillow&lt;12.0,&gt;=8.0, but you have pillow 12.1.0 which is incompatible.
gradio 5.50.0 requires pydantic&lt;=2.12.3,&gt;=2.0, but you have pydantic 2.12.5 which is incompatible.
access 1.1.10.post3 requires pandas&gt;=2.1.0, but you have pandas 1.5.3 which is incompatible.
opentelemetry-exporter-gcp-logging 1.11.0a0 requires opentelemetry-sdk&lt;1.39.0,&gt;=1.35.0, but you have opentelemetry-sdk 1.39.1 which is incompatible.
torchvision 0.24.0+cu126 requires torch==2.9.0, but you have torch 2.9.1 which is incompatible.
cudf-cu12 25.10.0 requires pandas&lt;2.4.0dev0,&gt;=2.0, but you have pandas 1.5.3 which is incompatible.
geopandas 1.1.1 requires pandas&gt;=2.0.0, but you have pandas 1.5.3 which is incompatible.
mizani 0.13.5 requires pandas&gt;=2.2.0, but you have pandas 1.5.3 which is incompatible.
opencv-contrib-python 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 1.26.4 which is incompatible.
gcsfs 2025.3.0 requires fsspec==2025.3.0, but you have fsspec 2026.1.0 which is incompatible.
langgraph-prebuilt 1.0.5 requires langchain-core&gt;=1.0.0, but you have langchain-core 0.1.23 which is incompatible.
google-ai-generativelanguage 0.6.15 requires protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;6.0.0dev,&gt;=3.20.2, but you have protobuf 6.33.3 which is incompatible.
dask-cudf-cu12 25.10.0 requires pandas&lt;2.4.0dev0,&gt;=2.0, but you have pandas 1.5.3 which is incompatible.
momepy 0.10.0 requires pandas&gt;=2.0, but you have pandas 1.5.3 which is incompatible.
bigframes 2.31.0 requires rich&lt;14,&gt;=12.4.4, but you have rich 14.2.0 which is incompatible.
spopt 0.7.0 requires pandas&gt;=2.1.0, but you have pandas 1.5.3 which is incompatible.
esda 2.8.0 requires pandas&gt;=2.1, but you have pandas 1.5.3 which is incompatible.
peft 0.18.0 requires huggingface_hub&gt;=0.25.0, but you have huggingface-hub 0.23.2 which is incompatible.
gradio-client 1.14.0 requires websockets&lt;16.0,&gt;=13.0, but you have websockets 16.0 which is incompatible.
mapclassify 2.10.0 requires pandas&gt;=2.1, but you have pandas 1.5.3 which is incompatible.
torchaudio 2.9.0+cu126 requires torch==2.9.0, but you have torch 2.9.1 which is incompatible.
jaxlib 0.7.2 requires numpy&gt;=2.0, but you have numpy 1.26.4 which is incompatible.
google-cloud-bigquery 3.38.0 requires packaging&gt;=24.2.0, but you have packaging 23.2 which is incompatible.
opencv-python 4.12.0.88 requires numpy&lt;2.3.0,&gt;=2; python_version &gt;= "3.9", but you have numpy 1.26.4 which is incompatible.
opentelemetry-exporter-otlp-proto-http 1.37.0 requires opentelemetry-exporter-otlp-proto-common==1.37.0, but you have opentelemetry-exporter-otlp-proto-common 1.39.1 which is incompatible.
opentelemetry-exporter-otlp-proto-http 1.37.0 requires opentelemetry-proto==1.37.0, but you have opentelemetry-proto 1.39.1 which is incompatible.
opentelemetry-exporter-otlp-proto-http 1.37.0 requires opentelemetry-sdk~=1.37.0, but you have opentelemetry-sdk 1.39.1 which is incompatible.
shap 0.50.0 requires numpy&gt;=2, but you have numpy 1.26.4 which is incompatible.
grpcio-status 1.71.2 requires protobuf&lt;6.0dev,&gt;=5.26.1, but you have protobuf 6.33.3 which is incompatible.
db-dtypes 1.4.4 requires packaging&gt;=24.2.0, but you have packaging 23.2 which is incompatible.
langgraph-checkpoint 3.0.1 requires langchain-core&gt;=0.2.38, but you have langchain-core 0.1.23 which is incompatible.
pytensor 2.35.1 requires numpy&gt;=2.0, but you have numpy 1.26.4 which is incompatible.
inequality 1.1.2 requires pandas&gt;=2.1, but you have pandas 1.5.3 which is incompatible.
arviz 0.22.0 requires pandas&gt;=2.1.0, but you have pandas 1.5.3 which is incompatible.[0m[31m
[0m</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Note</strong>:<br>- After running the above cell, kindly restart the runtime (for Google Colab) or notebook kernel (for Jupyter Notebook), and run all cells sequentially from the next cell.<br>- On executing the above line of code, you might see a warning regarding package dependencies. This error message can be ignored as the above code ensures that all necessary libraries and their dependencies are maintained to successfully execute the code in <strong><em>this notebook</strong></em>.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [1]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>#Libraries for downloading and loading the llm
from huggingface_hub import hf_hub_download
from llama_cpp import Llama</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Question Answering using LLM</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Downloading and Loading the model</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [2]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>model_name_or_path = "TheBloke/Mistral-7B-Instruct-v0.2-GGUF"
model_basename = "mistral-7b-instruct-v0.2.Q6_K.gguf"</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [3]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>model_path = hf_hub_download(
    repo_id=model_name_or_path,
    filename=model_basename
)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">/usr/local/lib/python3.12/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>mistral-7b-instruct-v0.2.Q6_K.gguf:   0%|          | 0.00/5.94G [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [4]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>#uncomment the below snippet of code if the runtime is connected to GPU.
llm = Llama(
    model_path=model_path,
    n_ctx=2300,
    n_gpu_layers=38,
    n_batch=512
)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">AVX = 1 | AVX2 = 1 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | FMA = 1 | NEON = 0 | ARM_FMA = 0 | F16C = 1 | FP16_VA = 0 | WASM_SIMD = 0 | BLAS = 1 | SSE3 = 1 | SSSE3 = 1 | VSX = 0 | 
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>#Uncomment the below snippet of code if the runtime is connected to CPU only.
#llm = Llama(
#    model_path=model_path,
#    n_ctx=1024,
#    n_cores=-2
#)</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Response</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [5]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>def response(query,max_tokens=128,temperature=0,top_p=0.95,top_k=50):
    model_output = llm(
      prompt=query,
      max_tokens=max_tokens,
      temperature=temperature,
      top_p=top_p,
      top_k=top_k
    )

    return model_output['choices'][0]['text']</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [6]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>response("What treatment options are available for managing hypertension?")</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[6]:</div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nHypertension, or high blood pressure, is a common condition that can increase the risk of various health problems such as heart disease, stroke, and kidney damage. The good news is that there are several effective treatment options available to help manage hypertension and reduce the risk of complications. Here are some of the most commonly used treatments:\n\n1. Lifestyle modifications: Making lifestyle changes is often the first line of defense against hypertension. This may include eating a healthy diet rich in fruits, vegetables, whole grains, and lean proteins; limiting sodium intake; getting regular physical activity'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 1: What is the protocol for managing sepsis in a critical care unit?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input = "What is the protocol for managing sepsis in a critical care unit?"
response(user_input)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nSepsis is a life-threatening condition that can arise from an infection, and it requires prompt recognition and aggressive management in a critical care unit. The following are general steps for managing sepsis in a critical care unit:\n\n1. Early recognition: Recognize the signs and symptoms of sepsis early and initiate treatment as soon as possible. Sepsis can present with various clinical features, including fever or hypothermia, tachycardia or bradycardia, altered mental status, respiratory distress, and lactic acidosis.\n2. Resusc'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 2: What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_2 = "What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?"
response(user_input_2)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nAppendicitis is a medical condition characterized by inflammation of the appendix, a small tube-shaped organ located in the lower right side of the abdomen. The symptoms of appendicitis can vary from person to person, but some common signs include:\n\n1. Abdominal pain: The pain may start as a mild discomfort around the navel or in the lower right abdomen, which then gradually moves to the right lower quadrant and becomes more severe over time. The pain may be constant or intermittent and is often worsened by movement, coughing, or deep breathing'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 3: What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_3 = "What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?"
response(user_input_3)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>"\n\nSudden patchy hair loss, also known as alopecia areata, is a common autoimmune disorder that affects the hair follicles. It can result in round or oval bald patches on the scalp, but it can also occur on other parts of the body such as the beard area, eyebrows, or eyelashes.\n\nThe exact cause of alopecia areata is not known, but it's believed to be related to a problem with the immune system. Some possible triggers for this condition include stress, genetics, viral infections, and certain medications."</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 4:  What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_4 = "What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?"
response(user_input_4)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>"\n\nA person who has sustained a physical injury to brain tissue, also known as a traumatic brain injury (TBI), may require various treatments depending on the severity and location of the injury. Here are some common treatments recommended for TBIs:\n\n1. Emergency care: The first priority is to ensure the person's airway is clear, they are breathing, and their heart is beating normally. In severe cases, emergency surgery may be required to remove hematomas or other obstructions.\n2. Medications: Depending on the symptoms, medications may be prescribed to manage conditions such as"</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 5: What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_5 = "What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?"
response(user_input_5)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>"\n\nFirst and foremost, if you suspect that someone has fractured their leg while hiking, it's essential to ensure their safety and prevent further injury. Here are some necessary precautions:\n\n1. Keep the person calm and still: Encourage them to remain as still as possible to minimize pain and prevent worsening the injury.\n2. Assess the situation: Check for any signs of shock, such as pale skin, rapid heartbeat, or shallow breathing. If you notice these symptoms, seek medical help immediately.\n3. Immobilize the leg: Use a splint, sl"</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Question Answering using LLM with Prompt Engineering</h2></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [7]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>system_prompt = """
You are an AI assistant specializing in medical knowledge. Your role is to provide clear, precise, and medically reliable responses based on established medical guidelines and best practices.

When answering, prioritize factual correctness, align with widely accepted medical standards, and ensure clarity for both medical professionals and general users.
If a query requires specific reference materials beyond general medical knowledge, acknowledge the limitation rather than speculating.

"""</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 1: What is the protocol for managing sepsis in a critical care unit?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [8]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input = system_prompt+"\n"+ "What is the protocol for managing sepsis in a critical care unit?"
response(user_input)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt">Out[8]:</div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nSepsis is a life-threatening condition that can arise from an infection, typically in a critically ill or immunocompromised patient. The protocol for managing sepsis in a critical care unit involves several key steps:\n\n1. Early recognition and diagnosis: Sepsis should be suspected in any patient with suspected or confirmed infection who exhibits signs of organ dysfunction, such as altered mental status, respiratory distress, or decreased urine output. Rapid diagnostic tests, like lactate measurement and procalcitonin levels, can help confirm the diagnosis.\n\n2'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 2: What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_2 = system_prompt+"\n"+"What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?"
response(user_input_2,max_tokens=256)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nAppendicitis is an inflammatory condition of the appendix, a small tube-shaped organ located in the lower right side of the abdomen. The common symptoms include:\n1. Sudden pain in the lower right abdomen, often starting around the navel and then moving to the right side.\n2. Loss of appetite.\n3. Nausea and vomiting.\n4. Fever (often above 37.5¬∞C or 99.5¬∞F).\n5. Abdominal swelling and rigidity, especially in the lower right quadrant.\n6. Pain upon walking, coughing, or making other jarring movements.\n\nAppendicitis cannot be cured with medicine alone due to the risk of appendix rupture, which can lead to peritonitis, a serious inflammation of the abdominal cavity. If left untreated, it can be life-threatening. The standard treatment for appendicitis is surgical removal of the appendix, known as an appendectomy. This procedure can be performed laparoscopically (using small incisions and a camera) or open (larger incision).'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 3: What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_3 = system_prompt+"\n"+"What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?"
response(user_input_3,temperature=0.3,max_tokens=256)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>"\n\nSudden patchy hair loss, also known as alopecia areata, is an autoimmune disorder that results in the sudden loss of hair from specific areas of the scalp or other parts of the body. The exact cause of alopecia areata is not fully understood, but it's believed to be related to a problem with the immune system.\n\nThere isn't a cure for alopecia areata, but several treatments can help stimulate hair regrowth or slow down the progression of hair loss:\n\n1. Corticosteroids: These medications are often used to treat alopecia areata because they suppress the immune system and reduce inflammation. They can be applied directly to the affected area as a cream, ointment, or injected under the skin.\n2. Minoxidil: A topical medication that is applied to the scalp daily, minoxidil can help stimulate hair growth in some people with alopecia areata. It's available over-the-counter and prescription strengths.\n3. Diphencyprone (DPCP): This allergen is used to induce an allergic reaction on the"</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 4:  What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_4 = system_prompt+"\n"+"What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?"
response(user_input_4,max_tokens=256)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nA brain injury can result in various symptoms depending on the location and severity of the damage. Treatment options for a person with a brain injury typically involve a combination of interventions aimed at managing symptoms, promoting recovery, and addressing any underlying conditions. Here are some common treatments:\n\n1. Emergency care: For severe brain injuries, immediate medical attention is crucial to prevent further damage or complications. This may include surgery to remove hematomas (clots) or repair skull fractures, as well as supportive measures such as intubation and ventilation to maintain breathing and oxygenation.\n\n2. Medications: Depending on the specific symptoms of a brain injury, various medications may be prescribed to manage conditions such as seizures, pain, or swelling in the brain. For example, anti-inflammatory drugs like dexamethasone can help reduce brain swelling, while anticonvulsants like levetiracetam can prevent seizures.\n\n3. Rehabilitation: Rehabilitation is a crucial component of treatment for brain injuries, as it helps individuals regain lost function and improve overall quality of life. This may include physical therapy to address motor impairments, occupational'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 5: What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_5 = system_prompt+"\n"+"What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?"
response(user_input_5,temperature=0.3,max_tokens=256)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>"\n\nA leg fracture, specifically a diaphyseal or shaft fracture, can be quite debilitating. Here are some general precautions and treatment steps for such an injury:\n\n1. **Immediate Care:** If the person is in significant pain, unable to walk, or showing signs of shock (pale skin, rapid heartbeat, confusion), call emergency medical services immediately. Do not try to move them unless it's necessary to prevent further harm and ensure their safety.\n\n2. **Stabilization:** Once stabilized, apply a splint, sling, or other immobilizing device as needed to help keep the bone in place. This will reduce pain and prevent further damage. Be careful not to press directly on the fracture site when applying the splint.\n\n3. **Pain Management:** Over-the-counter pain relievers like acetaminophen or ibuprofen can be used for mild to moderate pain. Prescription pain medication may be necessary for severe injuries. Always consult a healthcare professional before taking any new medications.\n\n4. **Transportation:** If the person is stable and able to travel, arrange for transportation to a medical facility as soon as possible."</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Data Preparation for RAG</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Upgrade pip</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Reasoning</strong>:<br>The subtask is to upgrade pip. This command will perform the upgrade.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [12]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>!pip install --upgrade pip</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Requirement already satisfied: pip in /usr/local/lib/python3.12/dist-packages (25.3)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [11]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>#Libraries for processing dataframes,text
import json,os
import tiktoken
import pandas as pd

#Libraries for Loading Data, Chunking, Embedding, and Vector Databases
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain_community.document_loaders import PyMuPDFLoader
from langchain_community.embeddings.sentence_transformer import SentenceTransformerEmbeddings
from langchain_community.vectorstores import Chroma</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-error">---------------------------------------------------------------------------
ModuleNotFoundError                       Traceback (most recent call last)
/tmp/ipython-input-577216478.py in &lt;cell line: 0&gt;()
      5 
      6 #Libraries for Loading Data, Chunking, Embedding, and Vector Databases
----&gt; 7 from langchain.text_splitter import RecursiveCharacterTextSplitter
      8 from langchain_community.document_loaders import PyMuPDFLoader
      9 from langchain_community.embeddings.sentence_transformer import SentenceTransformerEmbeddings

ModuleNotFoundError: No module named 'langchain.text_splitter'

---------------------------------------------------------------------------
NOTE: If your import is failing due to a missing package, you can
manually install dependencies using either !pip or !apt.

To view examples of installing some common dependencies, click the
"Open Examples" button below.
---------------------------------------------------------------------------
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Loading the Data</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># uncomment and run the below code snippets if the dataset is present in the Google Drive
from google.colab import drive
drive.mount('/content/drive')</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Mounted at /content/drive
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>manual_pdf_path = "/content/drive/shared-with-me/University of Texas A.I/NLP/MedAssist/medical_diagnosis_manual.pdf"</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>pdf_loader = PyMuPDFLoader(manual_pdf_path)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-error">---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
/tmp/ipython-input-3035313452.py in &lt;cell line: 0&gt;()
----&gt; 1 pdf_loader = PyMuPDFLoader(manual_pdf_path)

/usr/local/lib/python3.12/dist-packages/langchain_community/document_loaders/pdf.py in __init__(self, file_path, headers, extract_images, **kwargs)
    350                 "`pip install pymupdf`"
    351             )
--&gt; 352         super().__init__(file_path, headers=headers)
    353         self.extract_images = extract_images
    354         self.text_kwargs = kwargs

/usr/local/lib/python3.12/dist-packages/langchain_community/document_loaders/pdf.py in __init__(self, file_path, headers)
     98                 self.file_path = str(temp_pdf)
     99         elif not os.path.isfile(self.file_path):
--&gt; 100             raise ValueError("File path %s is not a valid file or url" % self.file_path)
    101 
    102     def __del__(self) -&gt; None:

ValueError: File path /content/drive/shared-with-me/University of Texas A.I/NLP/MedAssist/medical_diagnosis_manual.pdf is not a valid file or url</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>manual = pdf_loader.load()</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Data Overview</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Checking the first 5 pages</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>for i in range(5):
    print(f"Page Number : {i+1}",end="\n")
    print(manual[i].page_content,end="\n")</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Page Number : 1

Page Number : 2

Page Number : 3
Table of Contents
1
Front    ................................................................................................................................................................................................................
1
Cover    .......................................................................................................................................................................................................
2
Front Matter    ...........................................................................................................................................................................................
53
1 - Nutritional Disorders    ...............................................................................................................................................................
53
Chapter 1. Nutrition: General Considerations    .....................................................................................................................
59
Chapter 2. Undernutrition    .............................................................................................................................................................
69
Chapter 3. Nutritional Support    ...................................................................................................................................................
76
Chapter 4. Vitamin Deficiency, Dependency &amp; Toxicity    ..................................................................................................
99
Chapter 5. Mineral Deficiency &amp; Toxicity    ..............................................................................................................................
108
Chapter 6. Obesity &amp; the Metabolic Syndrome    ...............................................................................................................
120
2 - Gastrointestinal Disorders    ..............................................................................................................................................
120
Chapter 7. Approach to the Patient With Upper GI Complaints    ...............................................................................
132
Chapter 8. Approach to the Patient With Lower GI Complaints    ...............................................................................
143
Chapter 9. Diagnostic &amp; Therapeutic GI Procedures    ....................................................................................................
150
Chapter 10. GI Bleeding    ............................................................................................................................................................
158
Chapter 11. Acute Abdomen &amp; Surgical Gastroenterology    .........................................................................................
172
Chapter 12. Esophageal &amp; Swallowing Disorders    ..........................................................................................................
183
Chapter 13. Gastritis &amp; Peptic Ulcer Disease    ..................................................................................................................
196
Chapter 14. Bezoars &amp; Foreign Bodies    ..............................................................................................................................
199
Chapter 15. Pancreatitis    ............................................................................................................................................................
206
Chapter 16. Gastroenteritis    ......................................................................................................................................................
213
Chapter 17. Malabsorption Syndromes    ..............................................................................................................................
225
Chapter 18. Irritable Bowel Syndrome    ................................................................................................................................
229
Chapter 19. Inflammatory Bowel Disease    .........................................................................................................................
241
Chapter 20. Diverticular Disease    ...........................................................................................................................................
246
Chapter 21. Anorectal Disorders    ............................................................................................................................................
254
Chapter 22. Tumors of the GI Tract    ......................................................................................................................................
275
3 - Hepatic &amp; Biliary Disorders    ............................................................................................................................................
275
Chapter 23. Approach to the Patient With Liver Disease    ...........................................................................................
294
Chapter 24. Testing for Hepatic &amp; Biliary Disorders    ......................................................................................................
305
Chapter 25. Drugs &amp; the Liver    ................................................................................................................................................
308
Chapter 26. Alcoholic Liver Disease    ....................................................................................................................................
314
Chapter 27. Fibrosis &amp; Cirrhosis    ............................................................................................................................................
322
Chapter 28. Hepatitis    ..................................................................................................................................................................
333
Chapter 29. Vascular Disorders of the Liver    .....................................................................................................................
341
Chapter 30. Liver Masses &amp; Granulomas    ..........................................................................................................................
348
Chapter 31. Gallbladder &amp; Bile Duct Disorders    ...............................................................................................................
362
4 - Musculoskeletal &amp; Connective Tissue Disorders    .........................................................................................
362
Chapter 32. Approach to the Patient With Joint Disease    ............................................................................................
373
Chapter 33. Autoimmune Rheumatic Disorders    ..............................................................................................................
391
Chapter 34. Vasculitis    .................................................................................................................................................................
416
Chapter 35. Joint Disorders    .....................................................................................................................................................
435
Chapter 36. Crystal-Induced Arthritides    ..............................................................................................................................
443
Chapter 37. Osteoporosis    .........................................................................................................................................................
448
Chapter 38. Paget's Disease of Bone    ..................................................................................................................................
451
Chapter 39. Osteonecrosis    .......................................................................................................................................................
455
Chapter 40. Infections of Joints &amp; Bones    ...........................................................................................................................
463
Chapter 41. Bursa, Muscle &amp; Tendon Disorders    .............................................................................................................
470
Chapter 42. Neck &amp; Back Pain    ...............................................................................................................................................
481
Chapter 43. Hand Disorders    ....................................................................................................................................................

Page Number : 4
491
Chapter 44. Foot &amp; Ankle Disorders    .....................................................................................................................................
502
Chapter 45. Tumors of Bones &amp; Joints    ...............................................................................................................................
510
5 - Ear, Nose, Throat &amp; Dental Disorders    ..................................................................................................................
510
Chapter 46. Approach to the Patient With Ear Problems    ...........................................................................................
523
Chapter 47. Hearing Loss    .........................................................................................................................................................
535
Chapter 48. Inner Ear Disorders    ............................................................................................................................................
542
Chapter 49. Middle Ear &amp; Tympanic Membrane Disorders    ........................................................................................
550
Chapter 50. External Ear Disorders    .....................................................................................................................................
554
Chapter 51. Approach to the Patient With Nasal &amp; Pharyngeal Symptoms    .......................................................
567
Chapter 52. Oral &amp; Pharyngeal Disorders    .........................................................................................................................
578
Chapter 53. Nose &amp; Paranasal Sinus Disorders    .............................................................................................................
584
Chapter 54. Laryngeal Disorders    ...........................................................................................................................................
590
Chapter 55. Tumors of the Head &amp; Neck    ...........................................................................................................................
600
Chapter 56. Approach to Dental &amp; Oral Symptoms    .......................................................................................................
619
Chapter 57. Common Dental Disorders    .............................................................................................................................
629
Chapter 58. Dental Emergencies    ..........................................................................................................................................
635
Chapter 59. Temporomandibular Disorders    ......................................................................................................................
641
6 - Eye Disorders    ............................................................................................................................................................................
641
Chapter 60. Approach to the Ophthalmologic Patient    ..................................................................................................
669
Chapter 61. Refractive Error    ...................................................................................................................................................
674
Chapter 62. Eyelid &amp; Lacrimal Disorders    ...........................................................................................................................
680
Chapter 63. Conjunctival &amp; Scleral Disorders    .................................................................................................................
690
Chapter 64. Corneal Disorders    ...............................................................................................................................................
703
Chapter 65. Glaucoma    ...............................................................................................................................................................
710
Chapter 66. Cataract    ...................................................................................................................................................................
713
Chapter 67. Uveitis    ......................................................................................................................................................................
719
Chapter 68. Retinal Disorders    .................................................................................................................................................
731
Chapter 69. Optic Nerve Disorders    ......................................................................................................................................
737
Chapter 70. Orbital Diseases    ..................................................................................................................................................
742
7 - Dermatologic Disorders    ....................................................................................................................................................
742
Chapter 71. Approach to the Dermatologic Patient    .......................................................................................................
755
Chapter 72. Principles of Topical Dermatologic Therapy    ............................................................................................
760
Chapter 73. Acne &amp; Related Disorders    ...............................................................................................................................
766
Chapter 74. Bullous Diseases    .................................................................................................................................................
771
Chapter 75. Cornification Disorders    .....................................................................................................................................
775
Chapter 76. Dermatitis    ...............................................................................................................................................................
786
Chapter 77. Reactions to Sunlight    ........................................................................................................................................
791
Chapter 78. Psoriasis &amp; Scaling Diseases    ........................................................................................................................
799
Chapter 79. Hypersensitivity &amp; Inflammatory Disorders    .............................................................................................
808
Chapter 80. Sweating Disorders    ............................................................................................................................................
811
Chapter 81. Bacterial Skin Infections    ...................................................................................................................................
822
Chapter 82. Fungal Skin Infections    ......................................................................................................................................
831
Chapter 83. Parasitic Skin Infections    ...................................................................................................................................
836
Chapter 84. Viral Skin Diseases    ............................................................................................................................................
841
Chapter 85. Pigmentation Disorders    ....................................................................................................................................
846
Chapter 86. Hair Disorders    .......................................................................................................................................................
855
Chapter 87. Nail Disorders    .......................................................................................................................................................
861
Chapter 88. Pressure Ulcers    ...................................................................................................................................................
867
Chapter 89. Benign Tumors    .....................................................................................................................................................
874
Chapter 90. Cancers of the Skin    ............................................................................................................................................
882
8 - Endocrine &amp; Metabolic Disorders    .............................................................................................................................
882
Chapter 91. Principles of Endocrinology    ............................................................................................................................
887
Chapter 92. Pituitary Disorders    ..............................................................................................................................................
901
Chapter 93. Thyroid Disorders    ................................................................................................................................................

Page Number : 5
921
Chapter 94. Adrenal Disorders    ................................................................................................................................................
936
Chapter 95. Polyglandular Deficiency Syndromes    ........................................................................................................
939
Chapter 96. Porphyrias    ..............................................................................................................................................................
949
Chapter 97. Fluid &amp; Electrolyte Metabolism    .....................................................................................................................
987
Chapter 98. Acid-Base Regulation &amp; Disorders    ..............................................................................................................
1001
Chapter 99. Diabetes Mellitus &amp; Disorders of Carbohydrate Metabolism    ........................................................
1024
Chapter 100. Lipid Disorders    ................................................................................................................................................
1034
Chapter 101. Amyloidosis    ......................................................................................................................................................
1037
Chapter 102. Carcinoid Tumors    ..........................................................................................................................................
1040
Chapter 103. Multiple Endocrine Neoplasia Syndromes    .........................................................................................
1046
9 - Hematology &amp; Oncology    ...............................................................................................................................................
1046
Chapter 104. Approach to the Patient With Anemia    ..................................................................................................
1050
Chapter 105. Anemias Caused by Deficient Erythropoiesis    ...................................................................................
1061
Chapter 106. Anemias Caused by Hemolysis    ...............................................................................................................
1078
Chapter 107. Neutropenia &amp; Lymphocytopenia    ...........................................................................................................
1086
Chapter 108. Thrombocytopenia &amp; Platelet Dysfunction    .........................................................................................
1097
Chapter 109. Hemostasis    ......................................................................................................................................................
1104
Chapter 110. Thrombotic Disorders    ...................................................................................................................................
1107
Chapter 111. Coagulation Disorders    ..................................................................................................................................
1113
Chapter 112. Bleeding Due to Abnormal Blood Vessels    ...........................................................................................
1116
Chapter 113. Spleen Disorders    ............................................................................................................................................
1120
Chapter 114. Eosinophilic Disorders    .................................................................................................................................
1126
Chapter 115. Histiocytic Syndromes    .................................................................................................................................
1131
Chapter 116. Myeloproliferative Disorders    .....................................................................................................................
1141
Chapter 117. Leukemias    .........................................................................................................................................................
1154
Chapter 118. Lymphomas    ......................................................................................................................................................
1164
Chapter 119. Plasma Cell Disorders    .................................................................................................................................
1172
Chapter 120. Iron Overload    ...................................................................................................................................................
1177
Chapter 121. Transfusion Medicine    ...................................................................................................................................
1186
Chapter 122. Overview of Cancer    ......................................................................................................................................
1198
Chapter 123. Tumor Immunology    .......................................................................................................................................
1204
Chapter 124. Principles of Cancer Therapy    ...................................................................................................................
1215
10 - Immunology; Allergic Disorders    ...........................................................................................................................
1215
Chapter 125. Biology of the Immune System    ...............................................................................................................
1227
Chapter 126. Immunodeficiency Disorders    ....................................................................................................................
1243
Chapter 127. Allergic &amp; Other Hypersensitivity Disorders    .......................................................................................
1263
Chapter 128. Transplantation    ...............................................................................................................................................
1281
11 - Infectious Diseases    ........................................................................................................................................................
1281
Chapter 129. Biology of Infectious Disease    ...................................................................................................................
1300
Chapter 130. Laboratory Diagnosis of Infectious Disease    ......................................................................................
1306
Chapter 131. Immunization    ...................................................................................................................................................
1313
Chapter 132. Bacteria &amp; Antibacterial Drugs    .................................................................................................................
1353
Chapter 133. Gram-Positive Cocci    ....................................................................................................................................
1366
Chapter 134. Gram-Positive Bacilli    ...................................................................................................................................
1376
Chapter 135. Gram-Negative Bacilli    .................................................................................................................................
1405
Chapter 136. Spirochetes    ......................................................................................................................................................
1413
Chapter 137. Neisseriaceae    .................................................................................................................................................
1419
Chapter 138. Chlamydia &amp; Mycoplasmas    ......................................................................................................................
1421
Chapter 139. Rickettsiae &amp; Related Organisms    ..........................................................................................................
1431
Chapter 140. Anaerobic Bacteria    ........................................................................................................................................
1450
Chapter 141. Mycobacteria    ...................................................................................................................................................
1470
Chapter 142. Fungi    ...................................................................................................................................................................
1493
Chapter 143. Approach to Parasitic Infections    .............................................................................................................
1496
Chapter 144. Nematodes (Roundworms)    .......................................................................................................................

</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Checking the number of pages</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>len(manual)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>4114</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Data Chunking</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>text_splitter = RecursiveCharacterTextSplitter.from_tiktoken_encoder(
    encoding_name='cl100k_base',
    chunk_size=512,
    chunk_overlap= 20
)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>document_chunks = pdf_loader.load_and_split(text_splitter)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>len(document_chunks)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>8158</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>document_chunks[0].page_content</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Table of Contents\n1\nFront    ................................................................................................................................................................................................................\n1\nCover    .......................................................................................................................................................................................................\n2\nFront Matter    ...........................................................................................................................................................................................\n53\n1 - Nutritional Disorders    ...............................................................................................................................................................\n53\nChapter 1. Nutrition: General Considerations    .....................................................................................................................\n59\nChapter 2. Undernutrition    .............................................................................................................................................................\n69\nChapter 3. Nutritional Support    ...................................................................................................................................................\n76\nChapter 4. Vitamin Deficiency, Dependency &amp; Toxicity    ..................................................................................................\n99\nChapter 5. Mineral Deficiency &amp; Toxicity    ..............................................................................................................................\n108\nChapter 6. Obesity &amp; the Metabolic Syndrome    ...............................................................................................................\n120\n2 - Gastrointestinal Disorders    ..............................................................................................................................................\n120\nChapter 7. Approach to the Patient With Upper GI Complaints    ...............................................................................\n132\nChapter 8. Approach to the Patient With Lower GI Complaints    ...............................................................................\n143\nChapter 9. Diagnostic &amp; Therapeutic GI Procedures    ....................................................................................................\n150\nChapter 10. GI Bleeding    ............................................................................................................................................................\n158\nChapter 11. Acute Abdomen &amp; Surgical Gastroenterology    .........................................................................................\n172\nChapter 12. Esophageal &amp; Swallowing Disorders    ..........................................................................................................\n183\nChapter 13. Gastritis &amp; Peptic Ulcer Disease    ..................................................................................................................\n196\nChapter 14. Bezoars &amp; Foreign Bodies    ..............................................................................................................................\n199\nChapter 15. Pancreatitis    ............................................................................................................................................................\n206\nChapter 16. Gastroenteritis    ......................................................................................................................................................\n213\nChapter 17. Malabsorption Syndromes    ..............................................................................................................................\n225\nChapter 18. Irritable Bowel Syndrome    ................................................................................................................................\n229\nChapter 19. Inflammatory Bowel Disease    .........................................................................................................................\n241\nChapter 20. Diverticular Disease    ...........................................................................................................................................\n246\nChapter 21. Anorectal Disorders    ............................................................................................................................................\n254\nChapter 22. Tumors of the GI Tract    ......................................................................................................................................\n275\n3 - Hepatic &amp; Biliary Disorders    ............................................................................................................................................\n275\nChapter 23. Approach to the Patient With Liver Disease    ...........................................................................................\n294\nChapter 24. Testing for Hepatic &amp; Biliary Disorders    ......................................................................................................\n305'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>document_chunks[2].page_content</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'491\nChapter 44. Foot &amp; Ankle Disorders    .....................................................................................................................................\n502\nChapter 45. Tumors of Bones &amp; Joints    ...............................................................................................................................\n510\n5 - Ear, Nose, Throat &amp; Dental Disorders    ..................................................................................................................\n510\nChapter 46. Approach to the Patient With Ear Problems    ...........................................................................................\n523\nChapter 47. Hearing Loss    .........................................................................................................................................................\n535\nChapter 48. Inner Ear Disorders    ............................................................................................................................................\n542\nChapter 49. Middle Ear &amp; Tympanic Membrane Disorders    ........................................................................................\n550\nChapter 50. External Ear Disorders    .....................................................................................................................................\n554\nChapter 51. Approach to the Patient With Nasal &amp; Pharyngeal Symptoms    .......................................................\n567\nChapter 52. Oral &amp; Pharyngeal Disorders    .........................................................................................................................\n578\nChapter 53. Nose &amp; Paranasal Sinus Disorders    .............................................................................................................\n584\nChapter 54. Laryngeal Disorders    ...........................................................................................................................................\n590\nChapter 55. Tumors of the Head &amp; Neck    ...........................................................................................................................\n600\nChapter 56. Approach to Dental &amp; Oral Symptoms    .......................................................................................................\n619\nChapter 57. Common Dental Disorders    .............................................................................................................................\n629\nChapter 58. Dental Emergencies    ..........................................................................................................................................\n635\nChapter 59. Temporomandibular Disorders    ......................................................................................................................\n641\n6 - Eye Disorders    ............................................................................................................................................................................\n641\nChapter 60. Approach to the Ophthalmologic Patient    ..................................................................................................\n669\nChapter 61. Refractive Error    ...................................................................................................................................................\n674\nChapter 62. Eyelid &amp; Lacrimal Disorders    ...........................................................................................................................\n680\nChapter 63. Conjunctival &amp; Scleral Disorders    .................................................................................................................\n690\nChapter 64. Corneal Disorders    ...............................................................................................................................................\n703\nChapter 65. Glaucoma    ...............................................................................................................................................................\n710\nChapter 66. Cataract    ...................................................................................................................................................................\n713\nChapter 67. Uveitis    ......................................................................................................................................................................\n719\nChapter 68. Retinal Disorders    .................................................................................................................................................\n731\nChapter 69. Optic Nerve Disorders    ......................................................................................................................................\n737\nChapter 70. Orbital Diseases    ..................................................................................................................................................\n742\n7 - Dermatologic Disorders    ....................................................................................................................................................\n742'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>document_chunks[3].page_content</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'742\n7 - Dermatologic Disorders    ....................................................................................................................................................\n742\nChapter 71. Approach to the Dermatologic Patient    .......................................................................................................\n755\nChapter 72. Principles of Topical Dermatologic Therapy    ............................................................................................\n760\nChapter 73. Acne &amp; Related Disorders    ...............................................................................................................................\n766\nChapter 74. Bullous Diseases    .................................................................................................................................................\n771\nChapter 75. Cornification Disorders    .....................................................................................................................................\n775\nChapter 76. Dermatitis    ...............................................................................................................................................................\n786\nChapter 77. Reactions to Sunlight    ........................................................................................................................................\n791\nChapter 78. Psoriasis &amp; Scaling Diseases    ........................................................................................................................\n799\nChapter 79. Hypersensitivity &amp; Inflammatory Disorders    .............................................................................................\n808\nChapter 80. Sweating Disorders    ............................................................................................................................................\n811\nChapter 81. Bacterial Skin Infections    ...................................................................................................................................\n822\nChapter 82. Fungal Skin Infections    ......................................................................................................................................\n831\nChapter 83. Parasitic Skin Infections    ...................................................................................................................................\n836\nChapter 84. Viral Skin Diseases    ............................................................................................................................................\n841\nChapter 85. Pigmentation Disorders    ....................................................................................................................................\n846\nChapter 86. Hair Disorders    .......................................................................................................................................................\n855\nChapter 87. Nail Disorders    .......................................................................................................................................................\n861\nChapter 88. Pressure Ulcers    ...................................................................................................................................................\n867\nChapter 89. Benign Tumors    .....................................................................................................................................................\n874\nChapter 90. Cancers of the Skin    ............................................................................................................................................\n882\n8 - Endocrine &amp; Metabolic Disorders    .............................................................................................................................\n882\nChapter 91. Principles of Endocrinology    ............................................................................................................................\n887\nChapter 92. Pituitary Disorders    ..............................................................................................................................................\n901\nChapter 93. Thyroid Disorders    ................................................................................................................................................'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">As expected, there are some overlaps</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Embedding</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>embedding_model = SentenceTransformerEmbeddings(model_name='thenlper/gte-large')</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">The cache for model files in Transformers v4.22.0 has been updated. Migrating your old cache. This is a one-time only operation. You can interrupt this and resume the migration later on by calling `transformers.utils.move_cache()`.
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>0it [00:00, ?it/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>modules.json:   0%|          | 0.00/385 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>README.md:   0%|          | 0.00/67.9k [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>sentence_bert_config.json:   0%|          | 0.00/57.0 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>config.json:   0%|          | 0.00/619 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>model.safetensors:   0%|          | 0.00/670M [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>tokenizer_config.json:   0%|          | 0.00/342 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>vocab.txt:   0%|          | 0.00/232k [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>tokenizer.json:   0%|          | 0.00/712k [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>special_tokens_map.json:   0%|          | 0.00/125 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>config.json:   0%|          | 0.00/191 [00:00&lt;?, ?B/s]</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>embedding_1 = embedding_model.embed_query(document_chunks[0].page_content)
embedding_2 = embedding_model.embed_query(document_chunks[1].page_content)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>print("Dimension of the embedding vector ",len(embedding_1))
len(embedding_1)==len(embedding_2)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Dimension of the embedding vector  1024
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>True</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>embedding_1,embedding_2</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>([-0.023748891428112984,
  0.011355780065059662,
  0.023862989619374275,
  0.007668232079595327,
  -0.04011338949203491,
  -0.008834361098706722,
  -0.03938177973031998,
  0.023500192910432816,
  0.03943829610943794,
  0.021923786029219627,
  0.027133610099554062,
  0.0038833965081721544,
  0.0184765737503767,
  -0.029608314856886864,
  -0.01654675230383873,
  -0.006720828823745251,
  -0.019303040578961372,
  -0.028991909697651863,
  -0.03576122596859932,
  0.014769470319151878,
  0.02229294367134571,
  0.009727769531309605,
  -0.05187783017754555,
  -0.028314698487520218,
  -0.014781770296394825,
  0.025842223316431046,
  0.0347013995051384,
  0.013641570694744587,
  0.05879194289445877,
  0.07159498333930969,
  -0.01120663806796074,
  -0.037840068340301514,
  0.027412621304392815,
  -0.06776992976665497,
  -0.019012710079550743,
  -0.0072977603413164616,
  0.035701360553503036,
  -0.0377948023378849,
  -0.023122351616621017,
  -0.04881471022963524,
  0.007309457287192345,
  -0.015277471393346786,
  0.023984385654330254,
  -0.01882554218173027,
  -0.02922765165567398,
  -0.009189668111503124,
  -0.005185117945075035,
  -0.007861507125198841,
  -0.020541096106171608,
  -0.02343098074197769,
  0.00646702665835619,
  -0.001962019130587578,
  0.017195379361510277,
  -0.02558574639260769,
  -6.082125037210062e-05,
  0.019440090283751488,
  -0.015504107810556889,
  -0.03534449264407158,
  -0.011633624322712421,
  0.03985976800322533,
  0.044819653034210205,
  0.010006560944020748,
  0.028319766744971275,
  -0.06491783261299133,
  0.040773872286081314,
  0.024059779942035675,
  0.00013343660975806415,
  -0.006464281119406223,
  0.02963205799460411,
  -0.001860645948909223,
  0.005945911165326834,
  0.02111293375492096,
  -0.002461574971675873,
  -0.008865687996149063,
  0.012166866101324558,
  -0.00543894711881876,
  -0.023850681260228157,
  -0.015020395629107952,
  0.015147803351283073,
  -0.010462645441293716,
  -0.007846610620617867,
  0.04920528829097748,
  0.014933924190700054,
  0.00917117390781641,
  -0.0499495230615139,
  -0.019874276593327522,
  -0.025388255715370178,
  0.04753568768501282,
  0.004174595233052969,
  0.005307824816554785,
  -0.005473054014146328,
  0.052670110017061234,
  -0.017379380762577057,
  -0.023559965193271637,
  0.03073498234152794,
  0.05006661266088486,
  -0.053694531321525574,
  0.05443919450044632,
  0.003998925909399986,
  -0.004828136879950762,
  0.041931651532649994,
  0.020939365029335022,
  -0.02286476641893387,
  0.0658579096198082,
  -0.04461636766791344,
  -0.03461061418056488,
  0.01895655319094658,
  -0.007990950718522072,
  -0.018922211602330208,
  -0.03803624212741852,
  -0.010115091688930988,
  -0.024415405467152596,
  0.024357439950108528,
  -0.00030809722375124693,
  -0.005110640078783035,
  0.045998018234968185,
  0.0008752996218390763,
  0.006077844183892012,
  -0.04341153800487518,
  0.03124217689037323,
  0.0074954284355044365,
  -0.0011797321494668722,
  0.026999887079000473,
  -0.006340523716062307,
  0.0079759880900383,
  -0.01037423126399517,
  -0.026546670123934746,
  0.04310387372970581,
  -0.03429208695888519,
  -0.019978871569037437,
  -0.002126124454662204,
  -0.05197594687342644,
  -0.017266234382987022,
  0.032155267894268036,
  -0.01040880661457777,
  0.007413056679069996,
  -0.033389825373888016,
  0.028490513563156128,
  0.03934352844953537,
  -0.07577022165060043,
  0.05742903798818588,
  0.036580998450517654,
  -0.021160295233130455,
  0.07379651814699173,
  0.020079409703612328,
  0.042871810495853424,
  -0.004558277782052755,
  -0.020847396925091743,
  -0.03610386326909065,
  0.03870072215795517,
  -0.030712341889739037,
  0.0007984407129697502,
  0.005373797379434109,
  0.003625271376222372,
  -0.0014153694501146674,
  0.011132878251373768,
  -0.010226050391793251,
  0.005492706783115864,
  0.0018774076597765088,
  0.013956052251160145,
  -0.024338895455002785,
  0.006362904328852892,
  -0.01106119342148304,
  0.039122648537158966,
  -0.028043599799275398,
  0.04730501025915146,
  -0.002498074434697628,
  -0.03228265792131424,
  -0.017400525510311127,
  -0.041889432817697525,
  0.023895565420389175,
  -0.0073744384571909904,
  -0.008586961776018143,
  0.030459657311439514,
  0.004348141606897116,
  0.041954003274440765,
  0.034730590879917145,
  0.004426479339599609,
  0.033148933202028275,
  0.06934010237455368,
  -0.04001627489924431,
  -0.0291727464646101,
  0.03180454671382904,
  0.08285724371671677,
  -0.009986110962927341,
  -0.013344387523829937,
  0.041679706424474716,
  -0.016093749552965164,
  -0.032822273671627045,
  -0.04147966206073761,
  0.00647331215441227,
  0.04401576519012451,
  -0.007781451102346182,
  0.02901780977845192,
  -0.008601563051342964,
  0.016354482620954514,
  -0.02451624721288681,
  0.018253671005368233,
  -0.0145924873650074,
  -0.04827897995710373,
  -0.0444369874894619,
  0.015894334763288498,
  -0.032082684338092804,
  0.01924688182771206,
  0.011463736183941364,
  -0.0366155281662941,
  0.046946898102760315,
  0.06021016091108322,
  -0.04354005679488182,
  -0.0047174012288451195,
  0.05213283374905586,
  -0.003943512681871653,
  0.014746804721653461,
  0.006599079351872206,
  -0.026021886616945267,
  -0.009051164612174034,
  -0.02312445640563965,
  0.006137658376246691,
  -0.022168027237057686,
  -0.013042665086686611,
  -0.0007564935949631035,
  0.00983049999922514,
  0.02804734744131565,
  0.03729437291622162,
  0.008547522127628326,
  0.01468341238796711,
  0.006596626713871956,
  0.037419576197862625,
  -0.013964287005364895,
  0.010453320108354092,
  -0.003963761031627655,
  0.025121361017227173,
  0.045054346323013306,
  0.07290313392877579,
  0.03728681802749634,
  -0.003303452394902706,
  0.06392877548933029,
  0.04075711965560913,
  0.006748945917934179,
  0.02358207479119301,
  0.012232876382768154,
  -0.01826903410255909,
  0.050720393657684326,
  0.04071749746799469,
  0.012151827104389668,
  0.009215236641466618,
  -0.009157105349004269,
  -0.005714513827115297,
  -0.0033276318572461605,
  0.029768195003271103,
  -0.019855845719575882,
  0.05693594738841057,
  0.045099131762981415,
  0.026919573545455933,
  -0.017479034140706062,
  -0.016005396842956543,
  0.023123249411582947,
  0.06094398349523544,
  -0.039889510720968246,
  -0.01603703945875168,
  0.02955903857946396,
  0.01184687577188015,
  -0.034251485019922256,
  0.02373402751982212,
  -0.0008957984391599894,
  0.03171547129750252,
  0.012191078625619411,
  0.010827838443219662,
  0.012571718543767929,
  -0.05118359625339508,
  -0.042880572378635406,
  -0.04682508111000061,
  -0.08154185116291046,
  -0.04551639407873154,
  -0.04817339777946472,
  0.013525260612368584,
  0.03667145594954491,
  -0.025605708360671997,
  0.02903650887310505,
  0.024189060553908348,
  -0.03893556818366051,
  -0.024435142055153847,
  -0.02218027412891388,
  0.03059648908674717,
  0.0232041347771883,
  0.018425652757287025,
  -0.03449791669845581,
  0.041907865554094315,
  -0.01641177199780941,
  0.019443973898887634,
  -0.020816732197999954,
  -0.023507660254836082,
  -0.0025470538530498743,
  -0.029608942568302155,
  0.0017766677774488926,
  0.00040877395076677203,
  -0.010824105702340603,
  0.0037721458356827497,
  -0.018257612362504005,
  -0.05950256809592247,
  -0.03317593038082123,
  -0.008777257986366749,
  -0.024006113409996033,
  0.011886326596140862,
  -0.06373094767332077,
  0.056290533393621445,
  0.012346071191132069,
  -0.05524315685033798,
  0.05758419260382652,
  0.020127825438976288,
  -0.03169097378849983,
  0.05041654035449028,
  0.010732241906225681,
  0.008296382613480091,
  -0.05069137364625931,
  0.06002959981560707,
  0.040987152606248856,
  0.016469266265630722,
  -0.008446021936833858,
  -0.02868691086769104,
  -0.017872346565127373,
  0.01434785034507513,
  0.029144758358597755,
  -0.028342949226498604,
  -0.05629932880401611,
  0.04888731241226196,
  0.013289190828800201,
  -0.07811824977397919,
  0.016006777063012123,
  -0.012167362496256828,
  -0.05414543300867081,
  -0.013721122406423092,
  -0.04526618868112564,
  0.01165713183581829,
  0.013640949502587318,
  0.025181911885738373,
  -0.022588061168789864,
  -0.024026870727539062,
  0.0037954237777739763,
  0.004528431221842766,
  0.045049604028463364,
  -0.0596783384680748,
  0.042564649134874344,
  0.040956225246191025,
  0.015031897462904453,
  0.01699075847864151,
  0.0391143262386322,
  -0.04103425517678261,
  0.01136452704668045,
  0.022139353677630424,
  0.0021265142131596804,
  0.01476138737052679,
  0.031269241124391556,
  0.010659584775567055,
  0.015429701656103134,
  0.06250304728746414,
  -0.027382489293813705,
  0.00271284906193614,
  0.014857606962323189,
  0.021171454340219498,
  0.0038205592427402735,
  0.013322065584361553,
  0.00990537740290165,
  -0.01747128739953041,
  -0.054497480392456055,
  -0.05281131714582443,
  0.026738326996564865,
  -0.004205943550914526,
  0.06397348642349243,
  -0.029836518689990044,
  0.040819309651851654,
  0.0015785051509737968,
  -0.03218914568424225,
  0.03987029567360878,
  -0.033899374306201935,
  -6.517967267427593e-05,
  0.04394276440143585,
  -0.009975113905966282,
  0.033921029418706894,
  -0.05026761069893837,
  0.02975218929350376,
  -0.03491423651576042,
  0.0068391477689146996,
  0.026082301512360573,
  0.009100152179598808,
  0.02359018661081791,
  -0.001016003661789,
  -0.00030293880263343453,
  -0.040202993899583817,
  -0.024163413792848587,
  0.0016398400766775012,
  -0.039742499589920044,
  0.01935523748397827,
  -0.001581879798322916,
  -0.04517582803964615,
  -0.0302430447191,
  0.02854110859334469,
  0.031601205468177795,
  0.04816528409719467,
  0.02293243259191513,
  0.02082262746989727,
  -0.0020148518960922956,
  0.028306659311056137,
  0.025012582540512085,
  -0.014546921476721764,
  0.0221409872174263,
  -0.05260475352406502,
  0.04916245862841606,
  0.020079724490642548,
  -0.03491266444325447,
  -0.030673343688249588,
  0.0034180337097495794,
  -0.04038573056459427,
  0.04866965487599373,
  0.007396728731691837,
  -0.03671281039714813,
  -0.032090552151203156,
  0.017669256776571274,
  0.010575870983302593,
  0.022547297179698944,
  -0.03584999218583107,
  -0.008971736766397953,
  -0.005757378879934549,
  0.027534017339348793,
  0.043814368546009064,
  -0.06249871850013733,
  0.0343218669295311,
  -0.027699515223503113,
  0.025073770433664322,
  0.0634729266166687,
  -0.021546348929405212,
  -0.052365198731422424,
  -0.05548521876335144,
  -0.018252277746796608,
  -0.038514308631420135,
  -0.0018319814698770642,
  0.0405876561999321,
  -0.005359387956559658,
  0.027898704633116722,
  -0.03420880809426308,
  0.05687430500984192,
  0.03565826267004013,
  -0.012126094661653042,
  -0.0030333716422319412,
  -0.014445960521697998,
  0.032344527542591095,
  0.0049277134239673615,
  0.052631769329309464,
  0.002292834920808673,
  -0.00484453933313489,
  0.014701415784657001,
  -0.050357844680547714,
  0.03346212953329086,
  -0.017869193106889725,
  -0.010921156033873558,
  0.01113932579755783,
  0.014591478742659092,
  0.009130963124334812,
  0.018453417345881462,
  -0.019061414524912834,
  -0.0026340768672525883,
  -0.0052844323217868805,
  0.046081867069005966,
  -0.062557652592659,
  -0.05859648808836937,
  0.0503043532371521,
  0.00773816742002964,
  -0.02140773832798004,
  0.03293786570429802,
  0.02834264189004898,
  -0.009294791147112846,
  0.027154624462127686,
  0.009349982254207134,
  -0.057469580322504044,
  0.023294296115636826,
  -0.04759436473250389,
  0.005326796788722277,
  -0.01019870676100254,
  -0.06365004926919937,
  0.004651758819818497,
  -0.018439853563904762,
  0.03408205136656761,
  -0.01830347068607807,
  -0.021609408780932426,
  -0.059272218495607376,
  -0.05362420901656151,
  -0.04428572207689285,
  0.004179789684712887,
  -0.018545646220445633,
  0.025494856759905815,
  0.036448415368795395,
  -0.028294602409005165,
  0.015341201797127724,
  -0.030773021280765533,
  -0.0001687882177066058,
  -0.004323650151491165,
  -0.020469030365347862,
  0.0020739168394356966,
  -0.0028054274152964354,
  -0.0008190756198018789,
  0.03337683528661728,
  -0.004399105906486511,
  -0.037732720375061035,
  -0.016811659559607506,
  -0.02195081114768982,
  -0.027794038876891136,
  -0.04455820843577385,
  0.0030032095964998007,
  -0.03185417875647545,
  -0.016063231974840164,
  -0.032623499631881714,
  -0.014128102920949459,
  -0.016845718026161194,
  -0.01330933254212141,
  0.010851588100194931,
  0.007763783447444439,
  0.03767577186226845,
  0.010064578615128994,
  -0.038084905594587326,
  0.05386162921786308,
  0.0241291094571352,
  -0.046887531876564026,
  0.003731845412403345,
  0.049333468079566956,
  0.014186304062604904,
  0.023818431422114372,
  -0.0033964042086154222,
  -0.03177476301789284,
  -0.02274920791387558,
  -0.038528744131326675,
  -0.008253884501755238,
  -0.05404871702194214,
  -0.016286546364426613,
  -0.057936474680900574,
  -0.007504106033593416,
  0.0017775616142898798,
  0.022452855482697487,
  0.014206519350409508,
  -0.03371372073888779,
  0.026796283200383186,
  -0.03087693080306053,
  0.01798955723643303,
  -0.02020265907049179,
  -0.012287485413253307,
  -0.0342969074845314,
  -0.031967297196388245,
  -0.016425611451268196,
  0.051823921501636505,
  0.004877860192209482,
  0.01607871614396572,
  -0.009476832114160061,
  0.053463272750377655,
  0.03882264718413353,
  -0.007691010367125273,
  -0.04594499617815018,
  -0.03964875638484955,
  -0.014549672603607178,
  -0.008293729275465012,
  0.020110487937927246,
  0.01792197674512863,
  -0.033844660967588425,
  0.02437235414981842,
  -0.0407925546169281,
  -0.010940102860331535,
  -0.013561124913394451,
  -0.0011968192411586642,
  0.004154500085860491,
  -0.0124019430950284,
  0.04065169766545296,
  -0.034733325242996216,
  -0.0007615205831825733,
  -0.03542006388306618,
  0.04690660536289215,
  0.03310905769467354,
  0.005330477375537157,
  -0.041729435324668884,
  -0.02182411216199398,
  -0.047446414828300476,
  -0.050625164061784744,
  0.04982440546154976,
  -0.02976343035697937,
  -0.026061320677399635,
  -0.05170504003763199,
  -0.013492750935256481,
  0.03115602768957615,
  -0.003536834614351392,
  0.05606941878795624,
  0.026570603251457214,
  0.01700531505048275,
  0.010321433655917645,
  -0.025564044713974,
  0.0196054857224226,
  0.00516127422451973,
  -0.018206289038062096,
  -0.0074272118508815765,
  7.978316602930136e-07,
  -0.046535931527614594,
  0.015137315727770329,
  -0.05080384388566017,
  -0.03804470971226692,
  -0.06988517940044403,
  -0.010503864847123623,
  0.052749015390872955,
  0.0015512153040617704,
  0.05102232098579407,
  -0.006389377173036337,
  -0.043034523725509644,
  -0.036064278334379196,
  0.04709542915225029,
  0.025328317657113075,
  0.03915015980601311,
  0.04684264212846756,
  0.023328406736254692,
  -0.011623368598520756,
  0.0010483511723577976,
  -0.014240667223930359,
  0.009950107894837856,
  -0.04634697735309601,
  0.07451242953538895,
  -0.0184538122266531,
  -0.05117163434624672,
  0.01494360901415348,
  0.05003869906067848,
  -0.051986198872327805,
  -0.04385179653763771,
  -0.017875945195555687,
  -0.017370037734508514,
  -0.002088014967739582,
  -0.043628472834825516,
  -0.0028836182318627834,
  0.020120035856962204,
  -0.022227086126804352,
  0.006655574310570955,
  0.03764980286359787,
  -0.01573285460472107,
  0.035125482827425,
  0.003938494715839624,
  0.040688466280698776,
  -0.021379631012678146,
  0.02739568054676056,
  0.03169401362538338,
  0.009291503578424454,
  -0.03231828659772873,
  -0.01279673632234335,
  -0.011026675812900066,
  0.009980064816772938,
  0.0015773748746141791,
  0.029135622084140778,
  -0.00843854434788227,
  -0.001000678283162415,
  0.04207579419016838,
  -0.014454060234129429,
  0.0038108951412141323,
  0.027881085872650146,
  0.007286516018211842,
  0.010311639867722988,
  -0.026455046609044075,
  -0.04821040853857994,
  -0.05019413307309151,
  0.02678816206753254,
  0.008292513899505138,
  0.03424623981118202,
  -0.05189361423254013,
  -0.0002756646426860243,
  0.02794794924557209,
  0.001037418725900352,
  -0.009700966067612171,
  -0.04711431637406349,
  -0.038229309022426605,
  -0.023712174966931343,
  -0.04399685189127922,
  -0.04185961186885834,
  -0.03735543414950371,
  0.019640564918518066,
  0.03581606224179268,
  -0.010686456225812435,
  -0.027277180925011635,
  0.02614806964993477,
  0.004757889546453953,
  -0.005134246777743101,
  0.0076012578792870045,
  -0.024016287177801132,
  0.0024790887255221605,
  -0.03436187282204628,
  -0.0425323024392128,
  -0.057914502918720245,
  -0.0021219763439148664,
  -0.016211792826652527,
  -0.013816837221384048,
  -0.005615827161818743,
  0.029517946764826775,
  0.00029189506312832236,
  0.03893737867474556,
  0.014137896709144115,
  0.012989018112421036,
  -0.01521151140332222,
  -0.07307466864585876,
  -0.01680125668644905,
  0.020710555836558342,
  -0.042033206671476364,
  0.0450553260743618,
  0.020374687388539314,
  -0.021931082010269165,
  0.026745464652776718,
  0.018748771399259567,
  -0.03186684846878052,
  -0.0016823611222207546,
  0.0083765322342515,
  0.028194831684231758,
  0.004651880357414484,
  -0.02470332942903042,
  -0.02420935034751892,
  -0.026018362492322922,
  -0.03382229059934616,
  0.0011069511529058218,
  -0.026050524786114693,
  0.007056108675897121,
  0.017374740913510323,
  -0.018557358533143997,
  0.006344474386423826,
  0.06259896606206894,
  0.011288413777947426,
  0.038594458252191544,
  -0.030234061181545258,
  0.014027159661054611,
  0.045272257179021835,
  -0.0023293595295399427,
  0.003748616436496377,
  0.032196566462516785,
  0.022704744711518288,
  -0.03156007453799248,
  0.025065822526812553,
  0.009440120309591293,
  -0.017260532826185226,
  0.0364527553319931,
  -0.03634768724441528,
  -0.01413027010858059,
  -0.04275676608085632,
  -0.020572567358613014,
  -0.012954059056937695,
  0.05167393758893013,
  0.0028102812357246876,
  0.008534841239452362,
  -0.011518064886331558,
  -0.005673856008797884,
  -0.04556562751531601,
  0.022449763491749763,
  -0.060490142554044724,
  -0.016326790675520897,
  0.020056473091244698,
  -0.029697613790631294,
  0.02019953355193138,
  -0.01476307399570942,
  -0.045855652540922165,
  0.016531262546777725,
  -0.010063176043331623,
  -0.009261989034712315,
  -0.031309083104133606,
  0.017694266512989998,
  0.001281529781408608,
  0.010137897916138172,
  -0.026017986238002777,
  -0.014658499509096146,
  0.01943724974989891,
  0.03922465816140175,
  -0.04070359468460083,
  -0.054297056049108505,
  0.022415203973650932,
  0.0022219412494450808,
  -0.023049458861351013,
  0.002225366421043873,
  -0.0012736868811771274,
  0.001288250437937677,
  -4.197347880108282e-05,
  0.021197225898504257,
  0.0014157878467813134,
  0.023528359830379486,
  5.43467394891195e-05,
  0.031877901405096054,
  0.005354896187782288,
  -0.015584253706037998,
  -0.024253392592072487,
  0.04037988930940628,
  0.014295780099928379,
  -0.037542399019002914,
  -0.038653552532196045,
  0.05334816128015518,
  0.04497124254703522,
  -0.019294491037726402,
  0.04041270911693573,
  0.013648533262312412,
  0.030426030978560448,
  -0.014573648571968079,
  0.005931664723902941,
  -0.03415563330054283,
  0.03462733328342438,
  0.03715984895825386,
  0.034619707614183426,
  0.009468412026762962,
  0.015568573959171772,
  0.06742574274539948,
  0.027055473998188972,
  -0.003916254732757807,
  0.015809783712029457,
  0.012545416131615639,
  -0.009869714267551899,
  0.018565747886896133,
  -0.036524198949337006,
  -0.0078280596062541,
  0.020871449261903763,
  -0.002982305595651269,
  -0.01903737522661686,
  -0.03015495091676712,
  -0.015780378133058548,
  -0.04368196800351143,
  -0.010160863399505615,
  0.04614029824733734,
  -0.0445193275809288,
  -0.0011250629322603345,
  -0.0026307262014597654,
  -0.013172968290746212,
  0.0029754051938652992,
  0.03267231583595276,
  0.011452268809080124,
  0.025576898828148842,
  0.08018805086612701,
  0.017565838992595673,
  -0.027232425287365913,
  0.05549541488289833,
  -0.0068381167948246,
  0.028406066820025444,
  -0.023752346634864807,
  0.014030900783836842,
  0.027869241312146187,
  0.01321755163371563,
  -0.03560711070895195,
  -0.027203580364584923,
  -0.05498191714286804,
  0.003975996747612953,
  -0.017654992640018463,
  -0.021476836875081062,
  0.027265474200248718,
  -0.02399645559489727,
  -0.030225669965147972,
  -0.030538175255060196,
  0.044897936284542084,
  -0.044495031237602234,
  0.010571030899882317,
  0.06164638698101044,
  -0.004573364742100239,
  -0.036484092473983765,
  0.04690801724791527,
  0.0014854595065116882,
  0.06731835007667542,
  0.013874173164367676,
  0.04892805963754654,
  0.0020295537542551756,
  0.03516444191336632,
  0.045142363756895065,
  -0.018593229353427887,
  -0.031248943880200386,
  0.03267762437462807,
  -0.02122066542506218,
  -0.04293807968497276,
  -0.03626721352338791,
  -0.04664066061377525,
  0.005118279252201319,
  -0.002160883042961359,
  0.012008662335574627,
  -0.028136756271123886,
  0.057518795132637024,
  0.0023193522356450558,
  -0.051782310009002686,
  0.010928981006145477,
  0.03630456328392029,
  -0.059277620166540146,
  0.02544909156858921,
  0.005231489893049002,
  0.042279601097106934,
  -0.0277117732912302,
  -0.02322416566312313,
  -0.04327275976538658,
  -0.030982904136180878,
  -0.013721447438001633,
  -0.041659288108348846,
  0.040906503796577454,
  -0.01919146440923214,
  -0.02251446433365345,
  -0.04560605436563492,
  -0.03680259734392166,
  -0.007914643734693527,
  0.012699853628873825,
  -0.04014512524008751,
  -0.035374924540519714,
  0.024775221943855286,
  0.054393697530031204,
  0.03524146229028702,
  0.005897819064557552,
  -0.024465546011924744,
  -0.013713023625314236,
  0.030388345941901207,
  0.08396349847316742,
  -0.010861801914870739,
  0.07138829678297043,
  0.027432097122073174,
  0.0013848048401996493,
  0.023905998095870018,
  -0.03128122538328171,
  0.03897732496261597,
  -0.023125655949115753,
  -0.023054521530866623,
  -0.02847537212073803,
  0.01860559917986393,
  0.024785850197076797,
  -0.05764302983880043,
  0.012463325634598732,
  0.047062214463949203,
  -0.02469584159553051,
  -0.009230722673237324,
  -0.07445072382688522,
  0.009996439330279827,
  -0.038884151726961136,
  -0.005595821421593428,
  -0.017899738624691963,
  0.00699915736913681,
  0.025177793577313423,
  0.01874186098575592,
  0.0046609994024038315,
  -0.04720684885978699,
  0.15966500341892242,
  0.034143924713134766,
  0.024451566860079765,
  -0.00024136604042723775,
  0.024307310581207275,
  0.03310642018914223,
  0.013078234158456326,
  -0.029353095218539238,
  0.009956424124538898,
  -0.039054024964571,
  0.04580295458436012,
  -0.011057024821639061,
  0.013119172304868698,
  0.01604575663805008,
  0.018511179834604263,
  0.053842756897211075,
  -0.05871947109699249,
  0.029303494840860367,
  0.018709491938352585,
  -0.05017510801553726,
  -0.06923550367355347,
  0.034000005573034286,
  -0.003083267016336322,
  -0.005995180923491716,
  0.007032100111246109,
  0.0006611160933971405,
  0.022032946348190308,
  -0.0151072321459651,
  -0.0016218926757574081,
  -0.019106823951005936,
  0.02522513084113598,
  -0.035681065171957016,
  0.02158181183040142,
  -0.013392015360295773,
  -0.02341361716389656,
  0.05717991292476654,
  -0.009869902394711971,
  -0.017865464091300964,
  0.0010759577853605151,
  0.006208857521414757,
  -0.026182765141129494,
  -0.01578924059867859,
  0.06980708986520767,
  -0.054672207683324814,
  0.011368933133780956,
  0.05492475628852844,
  -0.02348058857023716,
  0.03583180159330368,
  0.02391439862549305,
  -0.010127081535756588,
  0.05660503730177879,
  -0.02058800309896469,
  0.01553144957870245,
  -0.0143019063398242,
  -0.045070551335811615,
  0.01005801185965538,
  0.026270590722560883,
  -0.039527881890535355,
  -0.02030978351831436,
  0.006313565652817488,
  0.04058576747775078,
  0.013275972567498684,
  -0.03393753618001938,
  -0.0071763088926672935,
  -0.02118387073278427,
  5.094291191198863e-05,
  0.038087084889411926,
  0.010756844654679298,
  -0.007478495128452778,
  0.001405262970365584,
  -0.015219257213175297,
  ...],
 [-0.00937887653708458,
  -0.03617912903428078,
  0.009893727488815784,
  0.028136711567640305,
  -0.025475140661001205,
  0.015861613675951958,
  -0.02312636561691761,
  0.023062992841005325,
  0.007224583066999912,
  0.03801708295941353,
  0.029280707240104675,
  -0.008452977053821087,
  0.00927784014493227,
  -0.03886660560965538,
  -0.006421086844056845,
  0.013343711383640766,
  -0.027493484318256378,
  -0.015052407048642635,
  -0.0048746382817626,
  0.0042033689096570015,
  0.012562121264636517,
  -0.001898962422274053,
  -0.04382384940981865,
  0.0020915179047733545,
  -0.03462689369916916,
  0.011032774113118649,
  0.012121126055717468,
  0.009599706158041954,
  0.04219093918800354,
  0.03223162516951561,
  -0.03310935199260712,
  -0.02112584374845028,
  0.01650930382311344,
  -0.041986990720033646,
  -0.019498474895954132,
  -0.027327749878168106,
  0.028665652498602867,
  -0.0273362398147583,
  -0.034349989145994186,
  -0.056303419172763824,
  -0.00450423639267683,
  -0.01319466345012188,
  0.017635760828852654,
  -0.016698436811566353,
  -0.033428631722927094,
  0.0016711810603737831,
  -0.021022403612732887,
  -0.029922645539045334,
  0.014474276453256607,
  -0.021991509944200516,
  0.005807072855532169,
  -0.006051092874258757,
  0.027016591280698776,
  0.0022290495689958334,
  0.013970990665256977,
  0.03416816517710686,
  0.017837895080447197,
  -0.03748577833175659,
  -0.033253829926252365,
  0.04569252207875252,
  0.025483524426817894,
  0.006347630638629198,
  0.018527377396821976,
  -0.0643688440322876,
  0.03905435651540756,
  0.011330473236739635,
  -0.014104819856584072,
  -0.016700878739356995,
  0.02820730209350586,
  -0.02995285764336586,
  -0.001023537595756352,
  -0.0034996282774955034,
  -0.02805245853960514,
  -0.006057168822735548,
  0.00846958253532648,
  -0.007255764212459326,
  0.022548386827111244,
  0.01964808814227581,
  -0.000373237271560356,
  0.03275188058614731,
  -0.008450106717646122,
  0.02772759273648262,
  0.041683267802000046,
  0.014122195541858673,
  -0.05845038592815399,
  -0.00984680000692606,
  -0.024750862270593643,
  0.037186700850725174,
  0.013476435095071793,
  -0.00801384449005127,
  0.008286264725029469,
  0.05268620327115059,
  -0.006134029943495989,
  -0.01584579423069954,
  -0.015998955816030502,
  0.04491187632083893,
  -0.04544598609209061,
  0.03718593344092369,
  0.012657354585826397,
  0.020540133118629456,
  0.032951343804597855,
  0.012508542276918888,
  -0.01485157199203968,
  0.04233567789196968,
  -0.04184289649128914,
  -0.006385061889886856,
  0.008396725170314312,
  0.002016028156504035,
  -0.02053214982151985,
  -0.04355868697166443,
  0.01213635690510273,
  -0.041556429117918015,
  0.005086070857942104,
  0.015969309955835342,
  -0.003671063808724284,
  0.023332025855779648,
  0.004365331958979368,
  0.015950657427310944,
  -0.04596550762653351,
  0.03162084147334099,
  0.05881698802113533,
  -0.0020129806362092495,
  0.053992945700883865,
  -0.014997918158769608,
  0.011635336093604565,
  0.01380791887640953,
  -0.04888635501265526,
  0.05306413397192955,
  -0.026924168691039085,
  -0.034487124532461166,
  0.01529462356120348,
  -0.05532429739832878,
  -0.02445157803595066,
  0.003157816594466567,
  -0.012336893938481808,
  0.01233609952032566,
  -0.025114405900239944,
  0.02455788291990757,
  0.03437616676092148,
  -0.03967538848519325,
  0.020268015563488007,
  0.030544394627213478,
  -0.0025227651931345463,
  0.06844918429851532,
  0.01830863766372204,
  0.04082509130239487,
  0.0007709097117185593,
  0.0002455845824442804,
  -0.030063990503549576,
  0.03429102152585983,
  -0.04578506946563721,
  0.002561967819929123,
  0.0016440150793641806,
  0.024397674947977066,
  0.005570964887738228,
  0.00778679084032774,
  0.022453073412179947,
  0.002670072019100189,
  -0.010497746989130974,
  0.03199481591582298,
  -0.025722714141011238,
  -0.010626093484461308,
  -0.008281205780804157,
  0.017869213595986366,
  -0.016565777361392975,
  0.04256299138069153,
  -0.03643086180090904,
  0.006616134196519852,
  -0.015132395550608635,
  -0.03865177556872368,
  0.03603970631957054,
  -0.031480543315410614,
  -0.020982371643185616,
  0.038085296750068665,
  0.038435909897089005,
  0.03612399473786354,
  0.07090747356414795,
  0.008420990779995918,
  -0.0045531741343438625,
  0.05529989302158356,
  -0.04141855612397194,
  0.02704709954559803,
  -0.009504283778369427,
  0.06332120299339294,
  0.065976582467556,
  0.009697770699858665,
  0.04242340847849846,
  -0.02508702501654625,
  -0.03369700163602829,
  -0.03249858319759369,
  -0.0161789208650589,
  0.01130741462111473,
  -0.03477608412504196,
  0.007588132284581661,
  -0.003737380728125572,
  -0.011932190507650375,
  -0.04944746568799019,
  0.0022268188185989857,
  -0.01994478888809681,
  -0.07132304459810257,
  -0.04794175177812576,
  0.03347858041524887,
  -0.045371878892183304,
  0.008197451941668987,
  0.033673904836177826,
  0.004067391622811556,
  0.00789183471351862,
  0.06512551009654999,
  -0.03528754040598869,
  0.038891565054655075,
  0.0462072417140007,
  0.003381389193236828,
  -0.006793982349336147,
  -0.003650542814284563,
  -0.00764457369223237,
  -0.004720492288470268,
  -0.026536202058196068,
  0.0423864983022213,
  -0.02234126627445221,
  0.0036316141486167908,
  -0.0011893798364326358,
  0.0031498235184699297,
  0.041590217500925064,
  0.032067615538835526,
  -0.010988546535372734,
  -0.016164330765604973,
  0.017565574496984482,
  0.041487548500299454,
  -0.032191067934036255,
  -0.019178790971636772,
  -0.05241253599524498,
  0.03539762645959854,
  0.02008003555238247,
  0.06651151180267334,
  0.04662102088332176,
  0.01019403524696827,
  0.04669913277029991,
  0.02827269211411476,
  -0.006237877067178488,
  0.0579535998404026,
  -0.011693337932229042,
  0.022936150431632996,
  0.006897463463246822,
  0.02302689477801323,
  -0.03247051686048508,
  0.025996040552854538,
  -0.011791246943175793,
  0.0004256647080183029,
  -0.017969276756048203,
  0.01115466095507145,
  -0.012397956103086472,
  0.07225213944911957,
  0.015508156269788742,
  0.03519870713353157,
  -0.02236495353281498,
  0.009746146388351917,
  0.03498418629169464,
  0.046981703490018845,
  -0.032028473913669586,
  -0.01493668183684349,
  0.015848960727453232,
  0.018961884081363678,
  0.0017784693045541644,
  0.026727600023150444,
  0.015298387035727501,
  0.02083323709666729,
  -0.0005876231007277966,
  0.03462454304099083,
  0.01947842165827751,
  -0.038620222359895706,
  -0.022838708013296127,
  -0.06678597629070282,
  -0.04099167510867119,
  -0.040452487766742706,
  -0.04021714627742767,
  -0.00413986062631011,
  0.04336565360426903,
  -0.02600177936255932,
  0.016351282596588135,
  0.012506702914834023,
  -0.012529540807008743,
  -0.04307740181684494,
  0.007016955409198999,
  0.06921262294054031,
  0.011153588071465492,
  0.027857676148414612,
  -0.05026368424296379,
  0.054447874426841736,
  -0.01910548470914364,
  0.033878426998853683,
  -0.0007282813312485814,
  -0.02822205238044262,
  -0.0325043722987175,
  -0.023433595895767212,
  0.032722342759370804,
  -0.021892286837100983,
  -0.02636987529695034,
  0.005113392602652311,
  -0.011081939563155174,
  -0.054234109818935394,
  -0.0005470076575875282,
  -0.004040585830807686,
  -0.015804873779416084,
  0.024644926190376282,
  -0.05754469707608223,
  0.03439566120505333,
  0.02655732072889805,
  -0.02469257265329361,
  0.036763180047273636,
  0.0024183483328670263,
  -0.03900853917002678,
  0.023810572922229767,
  0.007613976486027241,
  0.026421988382935524,
  -0.03564784303307533,
  0.03968707099556923,
  0.05266017094254494,
  0.02964785322546959,
  -0.018523508682847023,
  -0.043391481041908264,
  -0.024210287258028984,
  0.004836698528379202,
  0.009262786246836185,
  -0.014934618957340717,
  -0.02316419966518879,
  0.02310575544834137,
  0.04042869806289673,
  -0.09174194931983948,
  0.02065938338637352,
  -0.03310934826731682,
  -0.051525793969631195,
  -0.01779087446630001,
  -0.032325442880392075,
  0.01875796914100647,
  -0.018786326050758362,
  0.03462173044681549,
  -0.01895926333963871,
  -0.022037019953131676,
  0.0008318040054291487,
  0.04375887289643288,
  0.03557392209768295,
  -0.02942357026040554,
  0.009641488082706928,
  0.053753022104501724,
  0.027006074786186218,
  0.0028752931393682957,
  0.031687863171100616,
  -0.04383428767323494,
  0.0005665054195560515,
  0.0030589376110583544,
  0.026743492111563683,
  -0.0022788785863667727,
  0.04313657805323601,
  -0.008482379838824272,
  0.004179520532488823,
  0.055073197931051254,
  -0.012226262129843235,
  -0.00729994336143136,
  0.030370531603693962,
  0.0394129678606987,
  -0.025528043508529663,
  0.002412456087768078,
  0.0358407162129879,
  0.011713085696101189,
  -0.032864462584257126,
  -0.07574053108692169,
  0.027276314795017242,
  0.016026895493268967,
  0.05619358271360397,
  -0.06119989603757858,
  0.08146129548549652,
  0.03302787244319916,
  -0.013512196019291878,
  0.04389059543609619,
  -0.03222087770700455,
  0.0075483317486941814,
  0.025845009833574295,
  -0.000886946392711252,
  0.05888042971491814,
  -0.04942813143134117,
  0.010201996192336082,
  0.009474537335336208,
  0.02198309823870659,
  0.02641255035996437,
  -0.01994146592915058,
  0.036007173359394073,
  -0.036099471151828766,
  -0.01735072024166584,
  -0.03462423384189606,
  -0.015528176911175251,
  -0.009124184027314186,
  -0.02201993204653263,
  0.026878826320171356,
  0.008398478850722313,
  -0.047247860580682755,
  -0.06249504163861275,
  0.029743220657110214,
  0.03556325286626816,
  0.03933800384402275,
  0.0014236316783353686,
  0.016393298283219337,
  -0.015086738392710686,
  0.03412088006734848,
  0.018836965784430504,
  -0.010371477343142033,
  0.012364668771624565,
  -0.009414337575435638,
  0.04374634847044945,
  0.01155508030205965,
  -0.02947808802127838,
  -0.001937108812853694,
  -0.005545221269130707,
  -0.013272914104163647,
  0.01540248654782772,
  0.015662509948015213,
  -0.03447560593485832,
  -0.05987166613340378,
  0.039775922894477844,
  -0.025263821706175804,
  -0.030424268916249275,
  -0.03588031232357025,
  -0.006461783312261105,
  -0.002610394498333335,
  0.006047707516700029,
  0.02001926116645336,
  -0.0849325880408287,
  -0.0006386461318470538,
  -0.013099772855639458,
  0.03996683284640312,
  0.07500602304935455,
  -0.03809008002281189,
  -0.05953036621212959,
  -0.026724981144070625,
  -0.016698461025953293,
  -0.022037509828805923,
  -0.0034433130640536547,
  0.04620550200343132,
  0.014675820246338844,
  0.034329719841480255,
  -0.033570997416973114,
  0.041121434420347214,
  0.01144846249371767,
  0.004757109098136425,
  -0.0015687723644077778,
  0.020005788654088974,
  0.036267347633838654,
  0.007380408700555563,
  0.02566341497004032,
  -0.004769742488861084,
  -0.050968702882528305,
  0.012391045689582825,
  -0.09079419076442719,
  0.0009511247626505792,
  0.008070279844105244,
  -0.011900439858436584,
  -0.0033568781800568104,
  0.022315459325909615,
  0.034563980996608734,
  0.0046754558570683,
  -0.01530829444527626,
  -0.0089031420648098,
  -0.016605915501713753,
  0.05767696723341942,
  -0.04235278069972992,
  -0.010595684871077538,
  0.049938835203647614,
  0.00022159266518428922,
  -0.019712885841727257,
  0.05489514023065567,
  0.005981562193483114,
  -0.014583430252969265,
  0.019352545961737633,
  0.021659819409251213,
  -0.046747349202632904,
  0.01978280209004879,
  -0.06318862736225128,
  0.017396148294210434,
  0.007376418448984623,
  -0.03207769617438316,
  0.004546147771179676,
  -0.022933874279260635,
  0.03125089034438133,
  0.01267103012651205,
  0.004955830052495003,
  -0.03826558217406273,
  -0.07071570307016373,
  -0.042540669441223145,
  -0.0015554617857560515,
  -0.047986190766096115,
  0.029706275090575218,
  0.032317452132701874,
  -0.0415288545191288,
  -0.03180354833602905,
  0.012675195001065731,
  -0.03441073000431061,
  0.00019577490456867963,
  -0.028660593554377556,
  0.000547340780030936,
  -0.028837168589234352,
  0.01807447150349617,
  0.045985374599695206,
  -0.04397449642419815,
  -0.027183102443814278,
  -0.015244754031300545,
  -0.007473404053598642,
  -0.0244027990847826,
  -0.039670877158641815,
  0.028082337230443954,
  0.005250496324151754,
  0.012534918263554573,
  -0.03223789855837822,
  -0.012799074873328209,
  0.004897977691143751,
  -0.015900537371635437,
  0.029639869928359985,
  -0.016098618507385254,
  0.01479382161051035,
  -0.0012269413564354181,
  -0.05519212782382965,
  0.040901146829128265,
  0.03850530460476875,
  -0.0339425764977932,
  -0.029199687764048576,
  0.029757358133792877,
  -0.027605609968304634,
  0.044314779341220856,
  -0.002968474058434367,
  -0.029628615826368332,
  -0.017963159829378128,
  -0.03979119658470154,
  -0.007523711305111647,
  -0.046420130878686905,
  -0.021246062591671944,
  -0.04656266048550606,
  -0.02121475338935852,
  -0.02291407436132431,
  0.039037466049194336,
  0.051736749708652496,
  -0.026323672384023666,
  0.011717647314071655,
  -0.06175164133310318,
  0.019786126911640167,
  -0.033158328384160995,
  -0.011622726917266846,
  -0.011448086239397526,
  -0.026759397238492966,
  -0.02050703391432762,
  0.018593845888972282,
  0.009043944999575615,
  0.01969577744603157,
  0.0020327214151620865,
  0.029838927090168,
  0.03445957228541374,
  -0.0223967544734478,
  -0.03830892965197563,
  -0.0564049631357193,
  -0.016871951520442963,
  0.014091622084379196,
  -0.009543665684759617,
  0.013902313075959682,
  -0.04226353019475937,
  0.03638068959116936,
  -0.05173731595277786,
  -0.005738044623285532,
  -0.006691754329949617,
  -0.03001558594405651,
  -0.017144015058875084,
  -0.0006554509745910764,
  0.03544678911566734,
  -0.02374221757054329,
  0.014809682033956051,
  -0.0076400586403906345,
  0.06662323325872421,
  0.0645814761519432,
  0.017509041354060173,
  -0.02992359735071659,
  -0.03750169277191162,
  -0.03172029182314873,
  -0.05210419371724129,
  0.04027711972594261,
  -0.02353939600288868,
  -0.01806771196424961,
  -0.024950439110398293,
  0.0134715111926198,
  0.029663890600204468,
  0.001742880092933774,
  0.062407199293375015,
  0.03497321903705597,
  0.002587332855910063,
  -0.026327883824706078,
  -0.025372911244630814,
  0.022307908162474632,
  0.047801584005355835,
  -0.006716725882142782,
  -0.023509997874498367,
  -0.0008507545571774244,
  -0.02215914987027645,
  0.017057588323950768,
  -0.04134392365813255,
  -0.027260249480605125,
  -0.05865244194865227,
  -0.019169798120856285,
  0.053198736160993576,
  0.027288740500807762,
  0.02429099567234516,
  0.024834254756569862,
  -0.040743134915828705,
  -0.04552709683775902,
  0.05097717046737671,
  -0.010865862481296062,
  0.03963785246014595,
  0.03658735007047653,
  -0.008950303308665752,
  -0.031113315373659134,
  0.03875742852687836,
  -0.011633635498583317,
  -0.017202096059918404,
  -0.057610947638750076,
  0.07160767167806625,
  0.03990429639816284,
  -0.06708263605833054,
  0.03473464399576187,
  0.04549827054142952,
  -0.06396488845348358,
  -0.04105332866311073,
  0.021203458309173584,
  -0.008185534738004208,
  -0.014653189107775688,
  -0.042807962745428085,
  -0.006239245180040598,
  0.010404334403574467,
  -0.00796677079051733,
  -0.012526115402579308,
  0.009161217138171196,
  -0.04020756855607033,
  0.06584516167640686,
  -0.006039745174348354,
  0.054664239287376404,
  -0.055166617035865784,
  -0.0030106068588793278,
  0.03131628409028053,
  0.014459448866546154,
  -0.02965983934700489,
  -0.023473674431443214,
  -0.008711501024663448,
  0.019841942936182022,
  0.01099501270800829,
  0.020031854510307312,
  -0.023708580061793327,
  0.00013074075104668736,
  0.02344054915010929,
  0.01128937304019928,
  0.03496725484728813,
  0.012320567853748798,
  -0.007205185946077108,
  0.023020658642053604,
  -0.03855745121836662,
  -0.051608555018901825,
  -0.04874419420957565,
  0.006186819169670343,
  0.04803130030632019,
  0.022463330999016762,
  -0.05901458486914635,
  0.010477149859070778,
  0.048463400453329086,
  0.018378041684627533,
  0.007918795570731163,
  -0.06350221484899521,
  -0.0748685970902443,
  -0.045326873660087585,
  -0.03398876264691353,
  0.0032179232221096754,
  -0.007043356075882912,
  0.00585523946210742,
  0.018346568569540977,
  -0.00740601634606719,
  -0.05405427888035774,
  0.0006582913920283318,
  0.017994672060012817,
  -0.025551557540893555,
  -0.0343022421002388,
  -0.04165111854672432,
  0.03365073353052139,
  -0.02853170782327652,
  -0.04037472605705261,
  -0.05566350370645523,
  0.00910096149891615,
  -0.037932563573122025,
  0.0023221264127641916,
  -0.006995371542870998,
  0.0064917393028736115,
  0.019486799836158752,
  0.030209893360733986,
  0.000837366736959666,
  0.01004176214337349,
  -0.0050304424948990345,
  -0.038183245807886124,
  0.00504189170897007,
  0.020294606685638428,
  -0.03380771726369858,
  0.04543262720108032,
  0.032958220690488815,
  -0.026190951466560364,
  0.06083878129720688,
  0.010807136073708534,
  0.009167482145130634,
  -0.011426174081861973,
  -0.008042195811867714,
  0.030391544103622437,
  -0.014317569322884083,
  -0.0501207560300827,
  -0.04404238611459732,
  -0.03010714240372181,
  -0.048608388751745224,
  0.024147415533661842,
  -0.023350879549980164,
  -0.006634143181145191,
  0.01649126224219799,
  -0.003236213233321905,
  -0.032586533576250076,
  0.05843278393149376,
  0.0005508965696208179,
  0.0077474904246628284,
  0.01742658019065857,
  0.02282373234629631,
  0.038436368107795715,
  -0.010259327478706837,
  0.02808680571615696,
  0.03436771407723427,
  -0.010327478870749474,
  -0.009794310666620731,
  -0.001990589778870344,
  0.01281686220318079,
  -0.02490200288593769,
  0.028434809297323227,
  -0.03473564237356186,
  -0.017184359952807426,
  -0.02186731994152069,
  -0.005437901243567467,
  0.013229094445705414,
  0.038138218224048615,
  0.013399341143667698,
  -0.0038599760737270117,
  0.01114540733397007,
  -0.005546955857425928,
  -0.03248899057507515,
  0.02709912694990635,
  -0.05714595690369606,
  -0.023614399135112762,
  0.03208915889263153,
  -0.016007045283913612,
  0.009784748777747154,
  -0.016647443175315857,
  -0.0764302909374237,
  0.009635561145842075,
  0.010479279793798923,
  -0.011234435252845287,
  -0.05757719650864601,
  0.014465343207120895,
  0.0038344983477145433,
  0.046287354081869125,
  0.0038379498291760683,
  -0.024109750986099243,
  0.024788301438093185,
  0.03469931706786156,
  -0.03488282114267349,
  -0.03707372397184372,
  0.04196140170097351,
  0.004118778742849827,
  0.01582389697432518,
  -0.012123667635023594,
  0.016709325835108757,
  0.021663617342710495,
  -0.01787647418677807,
  -0.000550760654732585,
  0.03202620521187782,
  -0.004393081646412611,
  -0.0029254115652292967,
  0.03282193839550018,
  -0.033588431775569916,
  0.017483921721577644,
  -0.03544316068291664,
  0.04125937819480896,
  -0.0035666506737470627,
  -0.050533756613731384,
  -0.03742777928709984,
  0.024579763412475586,
  0.05620703846216202,
  -0.03115754947066307,
  0.03191787749528885,
  0.00956316664814949,
  0.047942303121089935,
  -0.007966021075844765,
  0.029218649491667747,
  -0.0012446261243894696,
  0.02859465777873993,
  0.04142222926020622,
  0.042956266552209854,
  0.012001730501651764,
  0.04214093089103699,
  0.0702475756406784,
  0.007226705085486174,
  0.020386185497045517,
  0.030892323702573776,
  0.013412568718194962,
  -0.003384948940947652,
  -0.019573073834180832,
  -0.05054799094796181,
  -0.007210535928606987,
  0.03243464231491089,
  -0.031202690675854683,
  0.005166701506823301,
  -0.02317984029650688,
  -0.010785975493490696,
  -0.03232930228114128,
  -0.01902773790061474,
  0.0693058893084526,
  -0.06298897415399551,
  0.009770705364644527,
  0.003159284358844161,
  -0.007798515260219574,
  -0.008275119587779045,
  0.028297603130340576,
  -0.010682443156838417,
  -0.025528134778141975,
  0.0504121370613575,
  0.015639571473002434,
  -0.007142799906432629,
  0.03375719487667084,
  -0.002201421419158578,
  0.0005939040565863252,
  -0.0638885498046875,
  0.0023358731996268034,
  0.004224564880132675,
  0.02444470487535,
  -0.04135764762759209,
  0.023202603682875633,
  -0.04129514470696449,
  0.012200149707496166,
  -0.017162609845399857,
  -0.02101193182170391,
  0.08083724230527878,
  -0.05105510354042053,
  0.006147489883005619,
  -0.02792111225426197,
  0.018316928297281265,
  -0.02390492521226406,
  -0.0010686859022825956,
  0.038733936846256256,
  -0.00060437829233706,
  -0.03281870856881142,
  0.05887961760163307,
  0.017502762377262115,
  0.05170203372836113,
  0.0075125424191355705,
  0.05444838106632233,
  0.020524542778730392,
  0.022372998297214508,
  0.052968621253967285,
  -0.01004983950406313,
  -0.002725403755903244,
  0.026871392503380775,
  0.007623292971402407,
  -0.06695663928985596,
  -0.034425023943185806,
  -0.04689016938209534,
  -0.026359276846051216,
  0.00497224647551775,
  -0.024358371272683144,
  -0.01006893627345562,
  0.030294690281152725,
  -0.017937174066901207,
  -0.025263408198952675,
  -0.03597944602370262,
  0.00809122622013092,
  -0.05030649155378342,
  0.0266428180038929,
  0.014751714654266834,
  0.062320295721292496,
  -0.002156191738322377,
  -0.002339049242436886,
  -0.051872964948415756,
  -0.013329612091183662,
  -0.007747803349047899,
  -0.011010583490133286,
  0.03975565358996391,
  0.004030877724289894,
  -0.005913319997489452,
  -0.029583901166915894,
  -0.03966999799013138,
  -0.00474102608859539,
  0.0046140956692397594,
  -0.024724066257476807,
  -0.0210159532725811,
  0.03822825103998184,
  0.06085566431283951,
  0.005806502886116505,
  0.030230773612856865,
  -0.018271703273057938,
  0.020119287073612213,
  0.00568587938323617,
  0.061812758445739746,
  -0.012069943360984325,
  0.06704115867614746,
  0.0394715815782547,
  -0.020521217957139015,
  0.015193145722150803,
  -0.030718743801116943,
  0.0011536868987604976,
  -0.006264057010412216,
  -0.025557931512594223,
  -0.0021922269370406866,
  0.00414441479369998,
  0.0012867599725723267,
  -0.05869320407509804,
  -0.006036072038114071,
  0.06573623418807983,
  -0.010704468004405499,
  0.02052430249750614,
  -0.06063034012913704,
  0.037730541080236435,
  -0.04300735518336296,
  -0.02666689269244671,
  -0.04460441321134567,
  0.012662013061344624,
  0.007475447375327349,
  0.002440804848447442,
  0.003666948527097702,
  -0.049155235290527344,
  0.11887166649103165,
  0.04865662008523941,
  0.012974027544260025,
  -0.01981433667242527,
  0.013059115968644619,
  0.012751867063343525,
  0.010638839565217495,
  -0.013762086629867554,
  0.023337267339229584,
  -0.018303100019693375,
  0.01579354517161846,
  -0.002015157602727413,
  0.02839260920882225,
  0.012693578377366066,
  0.05621292069554329,
  0.04633276164531708,
  -0.03156749904155731,
  0.0012960695894435048,
  0.0037063106428831816,
  -0.046292949467897415,
  -0.06575662642717361,
  -0.027358321473002434,
  -0.010504776611924171,
  0.00827751588076353,
  -0.002864758251234889,
  -0.001282283803448081,
  0.05174912139773369,
  -0.035019636154174805,
  -0.00798741914331913,
  0.004022810608148575,
  0.03919170796871185,
  -0.036380376666784286,
  0.04677881672978401,
  -0.030736448243260384,
  -0.02012413740158081,
  0.041849978268146515,
  0.011476743035018444,
  -0.008780831471085548,
  0.007029567379504442,
  0.02650308795273304,
  -0.027511300519108772,
  -0.005791186820715666,
  0.038629524409770966,
  -0.04020526632666588,
  0.01084507443010807,
  0.05927003547549248,
  -0.055102020502090454,
  0.0276311207562685,
  0.02145504578948021,
  -0.013474773615598679,
  0.05242443084716797,
  -0.029602529481053352,
  0.01087730098515749,
  -0.0002634868142195046,
  -0.04440505802631378,
  0.0049749272875487804,
  -0.01538777258247137,
  -0.029063887894153595,
  -0.02543005719780922,
  -0.0025992123410105705,
  0.046542949974536896,
  0.006796677131205797,
  -0.03807850182056427,
  0.02763483114540577,
  0.007166260853409767,
  -0.0013534433674067259,
  0.026915064081549644,
  0.010539798066020012,
  -0.026653163135051727,
  -0.0031311979983001947,
  -0.01668993942439556,
  ...])</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Vector Database</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>out_dir = 'medical_db'

if not os.path.exists(out_dir):
  os.makedirs(out_dir)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>vectorstore = Chroma.from_documents(
    document_chunks,
    embedding_model,
    persist_directory=out_dir
)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>vectorstore = Chroma(persist_directory=out_dir,embedding_function=embedding_model)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>vectorstore.embeddings</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>HuggingFaceEmbeddings(client=SentenceTransformer(
  (0): Transformer({'max_seq_length': 512, 'do_lower_case': False}) with Transformer model: BertModel 
  (1): Pooling({'word_embedding_dimension': 1024, 'pooling_mode_cls_token': False, 'pooling_mode_mean_tokens': True, 'pooling_mode_max_tokens': False, 'pooling_mode_mean_sqrt_len_tokens': False, 'pooling_mode_weightedmean_tokens': False, 'pooling_mode_lasttoken': False})
  (2): Normalize()
), model_name='thenlper/gte-large', cache_folder=None, model_kwargs={}, encode_kwargs={}, multi_process=False)</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>vectorstore.similarity_search("What are the common symptoms and treatments for pulmonary embolism?",k=1)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>[Document(page_content='Chapter 194. Pulmonary Embolism\nIntroduction\nPulmonary embolism (PE) is the occlusion of ‚â• 1 pulmonary arteries by thrombi that originate\nelsewhere, typically in the large veins of the lower extremities or pelvis. Risk factors are\nconditions that impair venous return, conditions that cause endothelial injury or dysfunction,\nand underlying hypercoagulable states. Symptoms are nonspecific and include dyspnea,\npleuritic chest pain, cough, and, in severe cases, syncope or cardiorespiratory arrest. Signs are\nalso nonspecific and may include tachypnea, tachycardia, hypotension, and a loud pulmonic\ncomponent of the 2nd heart sound. Diagnosis is based on a CT angiogram, ventilation/perfusion\nscan, or a pulmonary arteriogram. Treatment is with anticoagulants and, sometimes, clot\ndissolution with thrombolytics or surgical removal. Preventive measures include anticoagulants\nand sometimes insertion of an inferior vena caval filter.\nPE affects an estimated 117 people per 100,000 person years, resulting in about 350,000 cases yearly,\nand causes up to 85,000 deaths/yr. PE affects mainly adults.\nEtiology\nNearly all PEs arise from thrombi in the lower extremity or pelvic veins (deep venous thrombosis [DVT]\n‚Äîsee p. 2224). Thrombi in either the lower extremity or pelvic veins may be occult. Risk of embolization is\nhigher with thrombi proximal to the calf veins. Thromboemboli can also originate in upper extremity veins\n(associated with central venous catheters) or from right-sided cardiac chambers. Risk factors for DVT and\nPE are similar in children and adults and include conditions that impair venous return, conditions that\ncause endothelial injury or dysfunction, and underlying hypercoagulability disorders (see\nTable 194-1). Bed rest and confinement without walking, even for a few hours, are common precipitators.\nPathophysiology\nOnce DVT develops, clots may dislodge and travel through the venous system and right side of the heart\nto lodge in the pulmonary arteries, where they partially or completely occlude one or more vessels. The', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2079, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''})]</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>vectorstore.similarity_search("What are the common symptoms and treatments for pulmonary embolism?",k=3)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>[Document(page_content='Chapter 194. Pulmonary Embolism\nIntroduction\nPulmonary embolism (PE) is the occlusion of ‚â• 1 pulmonary arteries by thrombi that originate\nelsewhere, typically in the large veins of the lower extremities or pelvis. Risk factors are\nconditions that impair venous return, conditions that cause endothelial injury or dysfunction,\nand underlying hypercoagulable states. Symptoms are nonspecific and include dyspnea,\npleuritic chest pain, cough, and, in severe cases, syncope or cardiorespiratory arrest. Signs are\nalso nonspecific and may include tachypnea, tachycardia, hypotension, and a loud pulmonic\ncomponent of the 2nd heart sound. Diagnosis is based on a CT angiogram, ventilation/perfusion\nscan, or a pulmonary arteriogram. Treatment is with anticoagulants and, sometimes, clot\ndissolution with thrombolytics or surgical removal. Preventive measures include anticoagulants\nand sometimes insertion of an inferior vena caval filter.\nPE affects an estimated 117 people per 100,000 person years, resulting in about 350,000 cases yearly,\nand causes up to 85,000 deaths/yr. PE affects mainly adults.\nEtiology\nNearly all PEs arise from thrombi in the lower extremity or pelvic veins (deep venous thrombosis [DVT]\n‚Äîsee p. 2224). Thrombi in either the lower extremity or pelvic veins may be occult. Risk of embolization is\nhigher with thrombi proximal to the calf veins. Thromboemboli can also originate in upper extremity veins\n(associated with central venous catheters) or from right-sided cardiac chambers. Risk factors for DVT and\nPE are similar in children and adults and include conditions that impair venous return, conditions that\ncause endothelial injury or dysfunction, and underlying hypercoagulability disorders (see\nTable 194-1). Bed rest and confinement without walking, even for a few hours, are common precipitators.\nPathophysiology\nOnce DVT develops, clots may dislodge and travel through the venous system and right side of the heart\nto lodge in the pulmonary arteries, where they partially or completely occlude one or more vessels. The', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2079, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''}),
 Document(page_content='PE can also arise from nonthrombotic sources (see Sidebar 194-1).\nSymptoms and Signs\nMost PEs are small, physiologically insignificant, and asymptomatic. Even when present, symptoms are\nnonspecific and vary in frequency and intensity, depending on the extent of pulmonary vascular occlusion\nand preexisting cardiopulmonary function.\nLarger emboli cause acute dyspnea, pleuritic chest pain, or both. Dyspnea may be intermittent or occur\nonly with exercise. Less common symptoms include cough and hemoptysis. The first symptom in an\nelderly patient may be altered mental status. Massive PE manifests with hypotension, tachycardia,\nsyncope, or cardiac arrest.\nThe most common signs of PE are tachycardia and tachypnea. Less commonly, patients have\nhypotension, a loud 2nd heart sound (S2) due to a loud pulmonic component (P2), and crackles or\nwheezing. In the presence of right ventricular failure, distended internal jugular veins and a right\nventricular heave may be evident, and right ventricular gallop (3rd and 4th heart sounds [S3 and S4]),\nwith or without tricuspid regurgitation, may be audible. Fever can occur; DVT and PE are often\noverlooked causes of fever.\nPulmonary infarction is typically characterized by chest pain (mainly pleuritic), fever, and, occasionally,\nhemoptysis. Chronic thromboembolic pulmonary hypertension causes symptoms and signs of right heart\nfailure, including exertional dyspnea, easy fatigue, and peripheral edema that develops over months to\nyears.\nDiagnosis\n‚Ä¢ High index of suspicion\n‚Ä¢ Assessment of pretest probability (based on clinical findings, pulse oximetry, and chest x-ray)\n‚Ä¢ Subsequent testing based on pre-test probability\nDiagnosis is challenging, because symptoms and signs are nonspecific and diagnostic tests have\nimperfect diagnostic accuracy or are invasive. Most important is to include PE in the differential diagnosis\nwhen nonspecific symptoms, such as dyspnea, pleuritic chest pain, fever, hemoptysis, and cough, are\nencountered. Thus, PE should be considered in the differential diagnosis of patients suspected of having', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2080, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''}),
 Document(page_content='‚Ä¢ Anticoagulation\n‚Ä¢ Inferior vena cava filter placement when anticoagulation contraindicated or ineffective\n‚Ä¢ Clot elimination (eg, thrombolytic therapy, embolectomy) for massive emboli\nInitial treatment of PE is O2 for hypoxemia and IV 0.9% saline and vasopressors for hypotension and\nanticoagulation. All patients with strongly suspected or confirmed PE should be hospitalized and, ideally,\nshould also be continually monitored for life-threatening cardiovascular complications in the first 24 to 48\nh. Clot elimination should be considered in patients with massive PE at the time of diagnosis.\nClot elimination: Clot elimination by means of embolectomy or dissolution by IV thrombolytic therapy\nshould be considered for hypotensive patients. It may also be indicated for patients with clinical, ECG, or\nechocardiographic evidence of right ventricular overload or failure, but data supporting use in these\npatients are scarce and not definitive, and controlled prospective studies are unlikely to be done.\nEmbolectomy is reserved for patients with PE who are hypotensive despite supportive measures\n(persistent systolic BP ‚â§ 90 mm Hg after fluid therapy and O2 or if pressor therapy is required) or on the\nverge of cardiac or respiratory arrest. Surgical embolectomy appears to improve survival in patients with\nmassive PE but is not widely available. Catheter-based embolectomy can be done by some interventional\nradiologists. The decision to proceed with embolectomy and the choice of technique depend on local\nresources and expertise.\nThrombolytic therapy with tissue plasminogen activator (tPA), streptokinase, or urokinase offers a\nnoninvasive way to rapidly restore pulmonary blood flow but is controversial because long-term benefits\ndo not clearly outweigh the risk of hemorrhage. In patients with submassive PE (ie, who are normotensive\nbut have right ventricular dysfunction), thrombolytics speed the resolution of radiographic abnormalities\nand the return of hemodynamic function (heart rate and right ventricular function) and prevent\ncardiopulmonary deterioration but have not been shown to improve survival. Some experts recommend\nthrombolytics for patients with submassive PE suspected on the basis of echocardiographic evidence of', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2084, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''})]</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Retriever</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>retriever = vectorstore.as_retriever(
    search_type='similarity',
    search_kwargs={'k': 2}
)</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>rel_docs = retriever.get_relevant_documents("What are the common symptoms and treatments for pulmonary embolism?")
rel_docs</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>[Document(page_content='Chapter 194. Pulmonary Embolism\nIntroduction\nPulmonary embolism (PE) is the occlusion of ‚â• 1 pulmonary arteries by thrombi that originate\nelsewhere, typically in the large veins of the lower extremities or pelvis. Risk factors are\nconditions that impair venous return, conditions that cause endothelial injury or dysfunction,\nand underlying hypercoagulable states. Symptoms are nonspecific and include dyspnea,\npleuritic chest pain, cough, and, in severe cases, syncope or cardiorespiratory arrest. Signs are\nalso nonspecific and may include tachypnea, tachycardia, hypotension, and a loud pulmonic\ncomponent of the 2nd heart sound. Diagnosis is based on a CT angiogram, ventilation/perfusion\nscan, or a pulmonary arteriogram. Treatment is with anticoagulants and, sometimes, clot\ndissolution with thrombolytics or surgical removal. Preventive measures include anticoagulants\nand sometimes insertion of an inferior vena caval filter.\nPE affects an estimated 117 people per 100,000 person years, resulting in about 350,000 cases yearly,\nand causes up to 85,000 deaths/yr. PE affects mainly adults.\nEtiology\nNearly all PEs arise from thrombi in the lower extremity or pelvic veins (deep venous thrombosis [DVT]\n‚Äîsee p. 2224). Thrombi in either the lower extremity or pelvic veins may be occult. Risk of embolization is\nhigher with thrombi proximal to the calf veins. Thromboemboli can also originate in upper extremity veins\n(associated with central venous catheters) or from right-sided cardiac chambers. Risk factors for DVT and\nPE are similar in children and adults and include conditions that impair venous return, conditions that\ncause endothelial injury or dysfunction, and underlying hypercoagulability disorders (see\nTable 194-1). Bed rest and confinement without walking, even for a few hours, are common precipitators.\nPathophysiology\nOnce DVT develops, clots may dislodge and travel through the venous system and right side of the heart\nto lodge in the pulmonary arteries, where they partially or completely occlude one or more vessels. The', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2079, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''}),
 Document(page_content='PE can also arise from nonthrombotic sources (see Sidebar 194-1).\nSymptoms and Signs\nMost PEs are small, physiologically insignificant, and asymptomatic. Even when present, symptoms are\nnonspecific and vary in frequency and intensity, depending on the extent of pulmonary vascular occlusion\nand preexisting cardiopulmonary function.\nLarger emboli cause acute dyspnea, pleuritic chest pain, or both. Dyspnea may be intermittent or occur\nonly with exercise. Less common symptoms include cough and hemoptysis. The first symptom in an\nelderly patient may be altered mental status. Massive PE manifests with hypotension, tachycardia,\nsyncope, or cardiac arrest.\nThe most common signs of PE are tachycardia and tachypnea. Less commonly, patients have\nhypotension, a loud 2nd heart sound (S2) due to a loud pulmonic component (P2), and crackles or\nwheezing. In the presence of right ventricular failure, distended internal jugular veins and a right\nventricular heave may be evident, and right ventricular gallop (3rd and 4th heart sounds [S3 and S4]),\nwith or without tricuspid regurgitation, may be audible. Fever can occur; DVT and PE are often\noverlooked causes of fever.\nPulmonary infarction is typically characterized by chest pain (mainly pleuritic), fever, and, occasionally,\nhemoptysis. Chronic thromboembolic pulmonary hypertension causes symptoms and signs of right heart\nfailure, including exertional dyspnea, easy fatigue, and peripheral edema that develops over months to\nyears.\nDiagnosis\n‚Ä¢ High index of suspicion\n‚Ä¢ Assessment of pretest probability (based on clinical findings, pulse oximetry, and chest x-ray)\n‚Ä¢ Subsequent testing based on pre-test probability\nDiagnosis is challenging, because symptoms and signs are nonspecific and diagnostic tests have\nimperfect diagnostic accuracy or are invasive. Most important is to include PE in the differential diagnosis\nwhen nonspecific symptoms, such as dyspnea, pleuritic chest pain, fever, hemoptysis, and cough, are\nencountered. Thus, PE should be considered in the differential diagnosis of patients suspected of having', metadata={'author': '', 'creationDate': 'D:20120615054440Z', 'creator': 'Atop CHM to PDF Converter', 'file_path': 'medical_diagnosis_manual.pdf', 'format': 'PDF 1.6', 'keywords': '', 'modDate': "D:20140421075319+10'00'", 'page': 2080, 'producer': 'Atop CHM to PDF Converter', 'source': 'medical_diagnosis_manual.pdf', 'subject': '', 'title': 'The Merck Manual of Diagnosis &amp; Therapy, 19th Edition', 'total_pages': 4114, 'trapped': ''})]</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>model_output = llm(
      "What treatment options are available for managing hypertension?",
      max_tokens=128,
      temperature=0,
      echo=False,
    )</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>model_output['choices'][0]['text']</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'\n\nHypertension, or high blood pressure, is a common condition that can increase the risk of various health problems such as heart disease, stroke, and kidney damage. The good news is that there are several effective treatment options available to help manage hypertension and reduce the risk of complications. Here are some of the most commonly used treatments:\n\n1. Lifestyle modifications: Making lifestyle changes is often the first line of defense against hypertension. This may include eating a healthy diet rich in fruits, vegetables, whole grains, and lean proteins; limiting sodium intake; getting regular physical activity'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The above response is somewhat generic and is solely based on the data the model was trained on, rather than the medical manual.  <br><br>Let's now provide our own context.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>System and User Prompt Template</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Prompts guide the model to generate accurate responses. Here, we define two parts:<br><br>    1. The system message describing the assistant's role.<br>    2. A user message template including context and the question.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Define the system prompt for the model
qna_system_message = """
You are an AI assistant designed to support professional doctors at St. Bernard's Medical Center. Your task is to provide evidence-based, concise, and relevant medical information to doctors' clinical questions based on the context provided.

User input will include the necessary context for you to answer their questions. This context will begin with the token: ###Context. The context contains references to specific portions of trusted medical literature and research articles relevant to the query, along with their source details.

When crafting your response:
1. Use only the provided context to answer the question.
2. If the answer is found in the context, respond with concise and actionable medical insights.
3. Include the source reference with the page number, journal name, or publication, as provided in the context.
4. If the question is unrelated to the context or the context is empty, clearly respond with: "Sorry, this is out of my knowledge base."

Please adhere to the following response guidelines:
- Provide clear, direct answers using only the given context.
- Do not include any additional information outside of the context.
- Avoid rephrasing or summarizing the context unless explicitly relevant to the question.
- If no relevant answer exists in the context, respond with: "Sorry, this is out of my knowledge base."
- If the context is not provided, your response should also be: "Sorry, this is out of my knowledge base."

Here is an example of how to structure your response:

Answer:
[Medical answer based on context]

Source:
[Source details with page or section]
"""</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Define the user message template
qna_user_message_template = """
###Context
Here are some excerpts from medical literature and their sources that are relevant to the clinical question mentioned below:
{context}

###Question
{question}
"""</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Response Function</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>def generate_rag_response(user_input,k=3,max_tokens=128,temperature=0,top_p=0.95,top_k=50):
    global qna_system_message,qna_user_message_template
    # Retrieve relevant document chunks
    relevant_document_chunks = retriever.get_relevant_documents(query=user_input,k=k)
    context_list = [d.page_content for d in relevant_document_chunks]

    # Combine document chunks into a single context
    context_for_query = ". ".join(context_list)

    user_message = qna_user_message_template.replace('{context}', context_for_query)
    user_message = user_message.replace('{question}', user_input)

    prompt = qna_system_message + '\n' + user_message

    # Generate the response
    try:
        response = llm(
                  prompt=prompt,
                  max_tokens=max_tokens,
                  temperature=temperature,
                  top_p=top_p,
                  top_k=top_k
                  )

        # Extract and print the model's response
        response = response['choices'][0]['text'].strip()
    except Exception as e:
        response = f'Sorry, I encountered the following error: \n {e}'

    return response</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Question Answering using RAG</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 1: What is the protocol for managing sepsis in a critical care unit?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input = "What is the protocol for managing sepsis in a critical care unit?"
generate_rag_response(user_input)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe recommended regimen for septic shock of unknown cause includes gentamicin or tobramycin 5.1 mg/kg IV once/day and a 3rd-generation cephalosporin such as ceftriaxone 2 g once/day, or ceftazidime 2 g IV q 8 h. Vancomycin should be added if resistant staphylococci or enterococci are suspected. If there is an abscess or other source, a drug effective against anaerobes (eg, metron'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 2: What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_2 = "What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?"
generate_rag_response(user_input_2)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe common symptoms for appendicitis include abdominal pain, anorexia, and abdominal tenderness. Appendicitis is typically treated through surgical removal of the appendix, either open or laparoscopic appendectomy. There is no cure for appendicitis via medicine alone.\n\nSource:\nThe Merck Manual of Diagnosis &amp; Therapy, 19th Edition\nChapter 11. Acute Abdomen &amp; Surgical Gastroenterology\n163. Appendicitis\n\nIf you have any questions or'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 3: What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_3 = "What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?"
generate_rag_response(user_input_3)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe provided context suggests that alopecia areata is a common cause of sudden patchy hair loss. Effective treatments include topical, intralesional, or systemic corticosteroids, topical minoxidil, topical anthralin, topical immunotherapy (diphencyprone or squaric acid dibutylester), or psoralen plus ultraviolet A (PUVA). The choice of treatment depends on the severity of hair loss.\n\nSource:\nThe Merck Manual of Diagnosis &amp; Therapy,'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 4:  What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_4 = "What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?"
generate_rag_response(user_input_4)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe treatment for a person with traumatic brain injury (TBI) includes supportive care such as preventing systemic complications due to immobilization, providing good nutrition, and preventing pressure ulcers. There is no specific treatment for TBI, but maintaining adequate brain perfusion and oxygenation and preventing complications of altered sensorium are important in the first few days after the injury (The Merck Manual of Diagnosis &amp; Therapy, 19th Edition, Chapter 174. Coma &amp; Impaired Consciousness, Section 1833; Chapter 32'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 5: What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_5 = "What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?"
generate_rag_response(user_input_5)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nFor a person with a fractured leg from a hiking trip, necessary precautions include immobilizing the affected limb using a cast or other supportive device. This decreases pain and facilitates healing by preventing further injury. Joints proximal and distal to the injury should also be immobilized. The Merck Manual recommends elevating the injured leg above the heart for the first 2 days to minimize swelling, and applying warmth (e.g., a heating pad) for 15-20 minutes to relieve pain and speed healing after 4'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Fine-tuning</h3></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Query 1: What is the protocol for managing sepsis in a critical care unit?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input = "What is the protocol for managing sepsis in a critical care unit?"
generate_rag_response(user_input,temperature=0.5)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe recommended regimen for septic shock of unknown cause includes gentamicin or tobramycin 5.1 mg/kg IV once/day along with a third-generation cephalosporin such as cefotaxime 2 g q 6 to 8 h or ceftriaxone 2 g once/day. If Pseudomonas is suspected, ceftazidime 2 g IV q 8 h should be used instead. Vancomycin must be added if resistant staphylococci or enterococci are'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Query 2: What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_2 = "What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?"
generate_rag_response(user_input_2,top_p=0.8,top_k=20)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe common symptoms for appendicitis include abdominal pain, anorexia, and abdominal tenderness. Appendicitis is typically treated through surgical removal of the appendix, either open or laparoscopic appendectomy. There is no cure for appendicitis via medicine alone.\n\nSource:\nThe Merck Manual of Diagnosis &amp; Therapy, 19th Edition\nChapter 11. Acute Abdomen &amp; Surgical Gastroenterology\n163. Appendicitis\n\nIf you have any questions or'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Query 3: What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_3 = "What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?"
generate_rag_response(user_input_3,max_tokens=200)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe provided context suggests that alopecia areata is a common cause of sudden patchy hair loss. Effective treatments include topical, intralesional, or systemic corticosteroids, topical minoxidil, topical anthralin, topical immunotherapy (diphencyprone or squaric acid dibutylester), or psoralen plus ultraviolet A (PUVA). The choice of treatment depends on the severity of hair loss.\n\nSource:\nThe Merck Manual of Diagnosis &amp; Therapy, 19th Edition, Chapter 86. Hair Disorders, pages 847-852.'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Query 4:  What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_4 = "What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?"
generate_rag_response(user_input_4,top_p=0.85,top_k=20,temperature=0.9)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nThe recommended treatments for a person with a traumatic brain injury include supportive care such as preventing systemic complications due to immobilization, providing good nutrition, and preventing pressure ulcers. There is no specific treatment mentioned in the context for regaining normal function or improving communication and comprehension abilities.\n\nSource:\nThe Merck Manual of Diagnosis &amp; Therapy, 19th Edition\nChapter 174. Coma &amp; Impaired Consciousness\n1833. Chapter 324. Traumatic Brain Injury'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">#### Query 5: What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_input_5 = "What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?"
generate_rag_response(user_input_5,k=4)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>'Answer:\nFor a person with a fractured leg from a hiking trip, necessary precautions include immobilizing the affected limb using a cast or other supportive device. This decreases pain and facilitates healing by preventing further injury. Joints proximal and distal to the injury should also be immobilized. The Merck Manual recommends elevating the injured leg above the heart for the first 2 days to minimize swelling, and applying warmth (e.g., a heating pad) for 15-20 minutes to relieve pain and speed healing after 4'</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Output Evaluation</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Let us now use the LLM-as-a-judge method to check the quality of the RAG system on two parameters - retrieval and generation. We illustrate this evaluation based on the answeres generated to the question from the previous section.<br><br>- We are using the same Mistral model for evaluation, so basically here the llm is rating itself on how well he has performed in the task.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>groundedness_rater_system_message = """
You are tasked with rating AI generated answers to questions posed by users.
You will be presented a question, context used by the AI system to generate the answer and an AI generated answer to the question.
In the input, the question will begin with ###Question, the context will begin with ###Context while the AI generated answer will begin with ###Answer.

Evaluation criteria:
The task is to judge the extent to which the metric is followed by the answer.
1 - The metric is not followed at all
2 - The metric is followed only to a limited extent
3 - The metric is followed to a good extent
4 - The metric is followed mostly
5 - The metric is followed completely

Metric:
The answer should be derived only from the information presented in the context

Instructions:
1. First write down the steps that are needed to evaluate the answer as per the metric.
2. Give a step-by-step explanation if the answer adheres to the metric considering the question and context as the input.
3. Next, evaluate the extent to which the metric is followed.
4. Use the previous information to rate the answer using the evaluaton criteria and assign a score.
"""</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>relevance_rater_system_message = """
You are tasked with rating AI generated answers to questions posed by users.
You will be presented a question, context used by the AI system to generate the answer and an AI generated answer to the question.
In the input, the question will begin with ###Question, the context will begin with ###Context while the AI generated answer will begin with ###Answer.

Evaluation criteria:
The task is to judge the extent to which the metric is followed by the answer.
1 - The metric is not followed at all
2 - The metric is followed only to a limited extent
3 - The metric is followed to a good extent
4 - The metric is followed mostly
5 - The metric is followed completely

Metric:
Relevance measures how well the answer addresses the main aspects of the question, based on the context.
Consider whether all and only the important aspects are contained in the answer when evaluating relevance.

Instructions:
1. First write down the steps that are needed to evaluate the context as per the metric.
2. Give a step-by-step explanation if the context adheres to the metric considering the question as the input.
3. Next, evaluate the extent to which the metric is followed.
4. Use the previous information to rate the context using the evaluaton criteria and assign a score.
"""</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>user_message_template = """
###Question
{question}

###Context
{context}

###Answer
{answer}
"""</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>def generate_ground_relevance_response(user_input,k=3,max_tokens=128,temperature=0,top_p=0.95,top_k=50):
    global qna_system_message,qna_user_message_template
    # Retrieve relevant document chunks
    relevant_document_chunks = retriever.get_relevant_documents(query=user_input,k=3)
    context_list = [d.page_content for d in relevant_document_chunks]
    context_for_query = ". ".join(context_list)

    # Combine user_prompt and system_message to create the prompt
    prompt = f"""[INST]{qna_system_message}\n
                {'user'}: {qna_user_message_template.format(context=context_for_query, question=user_input)}
                [/INST]"""

    response = llm(
            prompt=prompt,
            max_tokens=max_tokens,
            temperature=temperature,
            top_p=top_p,
            top_k=top_k,
            stop=['INST'],
            echo=False
            )

    answer =  response["choices"][0]["text"]

    # Combine user_prompt and system_message to create the prompt
    groundedness_prompt = f"""[INST]{groundedness_rater_system_message}\n
                {'user'}: {user_message_template.format(context=context_for_query, question=user_input, answer=answer)}
                [/INST]"""

    # Combine user_prompt and system_message to create the prompt
    relevance_prompt = f"""[INST]{relevance_rater_system_message}\n
                {'user'}: {user_message_template.format(context=context_for_query, question=user_input, answer=answer)}
                [/INST]"""

    response_1 = llm(
            prompt=groundedness_prompt,
            max_tokens=max_tokens,
            temperature=temperature,
            top_p=top_p,
            top_k=top_k,
            stop=['INST'],
            echo=False
            )

    response_2 = llm(
            prompt=relevance_prompt,
            max_tokens=max_tokens,
            temperature=temperature,
            top_p=top_p,
            top_k=top_k,
            stop=['INST'],
            echo=False
            )

    return response_1['choices'][0]['text'],response_2['choices'][0]['text']</pre></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 1: What is the protocol for managing sepsis in a critical care unit?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>ground,rel = generate_ground_relevance_response(user_input="What is the protocol for managing sepsis in a critical care unit?",max_tokens=370)

print(ground,end="\n\n")
print(rel)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream"> Steps to evaluate the answer:
1. Identify the key information in the context related to managing sepsis in a critical care unit.
2. Compare the AI generated answer with the identified key information from the context.
3. Determine if the answer is derived only from the information presented in the context.

Explanation:
The AI generated answer mentions administering antibiotics based on the suspected source and causative organisms, adding vancomycin for resistant staphylococci or enterococci, draining abscesses and excising necrotic tissues to eliminate septic foci, and normalizing blood glucose levels using a continuous IV insulin infusion.

The context provides information on supportive care for ICU patients, which includes prevention of infection and mentioning the importance of prompt empiric therapy for sepsis. It also mentions specific antibiotics such as gentamicin or tobramycin with a 3rd-generation cephalosporin, ceftazidime, or ciprofloxacin based on the suspected source and causative organisms, vancomycin for resistant staphylococci or enterococci, draining abscesses, and excising necrotic tissues.

The AI generated answer matches the information in the context exactly, so it can be concluded that the answer is derived only from the information presented in the context.

Evaluation:
The metric is followed completely.

Rating:
Based on the evaluation criteria, the rating for this answer would be 5 (The metric is followed completely).

 Steps to evaluate the context as per the relevance metric:
1. Identify the main aspects of the question: managing sepsis in a critical care unit.
2. Determine if the context provides information on these main aspects.
3. Check if all important details related to managing sepsis in a critical care unit are present in the context.
4. Evaluate if any irrelevant information is included that may distract from the main aspects of the question.

The context adheres to the relevance metric considering the question as follows:
1. The context discusses supportive care for ICU patients, which includes managing sepsis (Question's main aspect).
2. It provides detailed information on blood tests and antibiotic administration, which are crucial steps in managing sepsis in a critical care unit.
3. The context mentions the importance of draining abscesses and excising necrotic tissues to eliminate septic foci, which is another important aspect of managing sepsis.
4. It also discusses normalizing blood glucose levels, which improves outcome in critically ill patients, including those with sepsis.
5. The context does not include any irrelevant information that may distract from the main aspects of the question.

The metric is followed mostly as all important aspects related to managing sepsis in a critical care unit are present and accounted for in the context.

Rating: 4 (The metric is followed mostly)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 2: What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>ground,rel = generate_ground_relevance_response(user_input="What are the common symptoms for appendicitis, and can it be cured via medicine? If not, what surgical procedure should be followed to treat it?",max_tokens=350)

print(ground,end="\n\n")
print(rel)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream"> Steps to evaluate the answer:
1. Identify the information in the context related to the question.
2. Check if the symptoms mentioned in the answer are present in the context.
3. Verify if the treatment options given in the answer match those stated in the context.
4. Ensure that the answer is derived solely from the context and not any external sources.

Explanation:
The answer adheres to the metric as it mentions only the symptoms and treatment options directly taken from the context. The symptoms mentioned are abdominal pain, anorexia, and abdominal tenderness which are explicitly stated in the context. The treatment option given is surgical removal of the appendix through open or laparoscopic appendectomy, which is also stated in the context.

Evaluation:
The metric is followed completely as the answer is derived solely from the information provided in the context and does not include any external sources or additional information.

Rating:
Based on the evaluation criteria, I would rate this answer a 5 for following the metric completely.

 Steps to evaluate the context as per the relevance metric:
1. Identify the main aspects of the question: common symptoms for appendicitis and whether it can be cured via medicine or if surgery is required.
2. Determine if the context provides information on these main aspects.
3. Check if all important aspects are contained in the context and if any irrelevant information is present.

The context adheres to the metric considering the question as follows:
1. The context mentions that appendicitis causes abdominal pain, anorexia, and abdominal tenderness (common symptoms).
2. It states that treatment for appendicitis is surgical removal of the appendix, which cannot be cured via medicine.
3. There is no irrelevant information in the context.

The metric is followed mostly as all important aspects are contained in the context and there is no irrelevant information.

Rating: 4 (The metric is followed mostly)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 3: What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>ground,rel = generate_ground_relevance_response(user_input="What are the effective treatments or solutions for addressing sudden patchy hair loss, commonly seen as localized bald spots on the scalp, and what could be the possible causes behind it?",max_tokens=350)

print(ground,end="\n\n")
print(rel)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream"> Steps to evaluate the answer:
1. Identify the main question and the specific information being asked for in the question.
2. Read through the context provided to understand the key points related to the topic of hair loss and its treatments.
3. Determine if the AI generated answer directly addresses the question using only the information provided in the context.
4. Check if any additional or irrelevant information is included in the answer.

Evaluation:
The AI generated answer adheres to the metric as it is derived solely from the information presented in the context. The answer correctly identifies alopecia areata as a cause of sudden patchy hair loss and lists various treatment options for this condition, all of which are mentioned in the context. The possible causes of alopecia areata are also accurately stated from the context.

Rating:
Based on the evaluation criteria, I would rate the answer as a 5 since it follows the metric completely by deriving the answer solely from the information provided in the context.

 Steps to evaluate the context as per the relevance metric:
1. Identify the main aspects of the question: effective treatments or solutions for addressing sudden patchy hair loss and possible causes behind it.
2. Determine if the context provides information on these main aspects.
3. Check if all important aspects are contained in the context and if any irrelevant information is excluded.

The context adheres to the relevance metric considering the question as follows:
1. The context mentions various treatments for sudden patchy hair loss, which directly addresses the first aspect of the question.
2. It also discusses possible causes of sudden patchy hair loss, including autoimmune disorders and environmental triggers, addressing the second aspect of the question.
3. The context provides a comprehensive list of treatment options and their potential side effects, ensuring that all important aspects are covered.
4. The context excludes irrelevant information, such as details about hair loss due to chemotherapy or hormonal modulators for female-pattern hair loss not related to sudden patchy hair loss.

The metric is followed mostly since the context provides a complete and accurate answer to the question while excluding irrelevant information.

Rating: 4 (The metric is followed mostly)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 4: What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>ground,rel = generate_ground_relevance_response(user_input="What treatments are recommended for a person who has sustained a physical injury to brain tissue, resulting in temporary or permanent impairment of brain function?",max_tokens=350)

print(ground,end="\n\n")
print(rel)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream"> Steps to evaluate the answer:
1. Identify the key information in the context related to treatments for traumatic brain injury (TBI).
2. Compare the information in the context with the AI generated answer to ensure that the answer is derived only from the context.
3. Evaluate the extent to which the metric is followed.

Explanation:
The AI generated answer correctly identifies the source of the information and summarizes the recommended treatments for a person with TBI as mentioned in the context. The answer does not include any additional or irrelevant information, indicating that it has been derived solely from the context.

Evaluation:
The metric is followed completely.

Rating:
Based on the evaluation criteria, I would rate the AI generated answer as a 5, indicating that the metric is followed completely.

 Steps to evaluate the context as per the relevance metric:
1. Identify the main aspects of the question: The question asks about treatments for a person with brain injury and impairment of brain function.
2. Determine if the context discusses the main aspects: The context mentions supportive care as one of the treatments for patients with traumatic brain injury (TBI). It also provides details about what supportive care entails, such as preventing systemic complications, providing good nutrition, and preventing pressure ulcers.
3. Check if all important aspects are contained in the context: Yes, the context discusses all the important aspects of the question, which are the recommended treatments for a person with brain injury.

The metric is followed mostly because the context not only mentions that supportive care is one of the recommended treatments but also provides details about what supportive care entails. This information directly addresses the main aspects of the question and helps answer it completely.

Rating: 4 (The metric is followed mostly)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Query 5: What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>ground,rel = generate_ground_relevance_response(user_input="What are the necessary precautions and treatment steps for a person who has fractured their leg during a hiking trip, and what should be considered for their care and recovery?",max_tokens=350)

print(ground,end="\n\n")
print(rel)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream output-stderr">Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
Llama.generate: prefix-match hit
</div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream"> Steps to evaluate the answer:
1. Identify the information in the context related to the question about fractured leg precautions and treatment.
2. Check if the AI generated answer includes only the information from the context.
3. Compare each detail in the answer with the corresponding detail in the context to ensure consistency.

Explanation:
The AI generated answer adheres to the metric as it is derived solely from the information presented in the context. The answer mentions immobilizing the injured limb, elevating it above the heart for the first 2 days, applying warmth after 48 hours, keeping the cast dry, avoiding putting objects inside it, inspecting the cast's edges and skin daily, and padding any rough edges to prevent discomfort. All these details are directly taken from the context provided in the Merck Manual.

Rating:
Based on the evaluation criteria, I would rate this answer as a 5 because the metric is followed completely. The AI generated answer is derived only from the information presented in the context and accurately reflects the necessary precautions and treatment steps for a person with a fractured leg according to the Merck Manual.

 Steps to evaluate the context as per the relevance metric:
1. Identify the main aspects of the question: necessary precautions and treatment steps for a person with a fractured leg.
2. Determine if each piece of information in the context addresses these main aspects.
3. Check if all important aspects are contained in the context and if any irrelevant information is missing.

The context adheres to the metric considering the question as the input because:
1. The context provides necessary precautions such as immobilizing the injured limb, elevating it above the heart for the first 2 days, applying warmth after 48 hours, and keeping the cast dry.
2. It also mentions treatment steps like using a cast or other supportive device, inspecting the cast's edges and skin daily, and padding any rough edges to prevent discomfort.
3. The context is relevant as it covers all important aspects of the question based on the provided context.

The metric is followed mostly because the context not only mentions the necessary precautions and treatment steps but also provides additional information that supports the main aspects, such as elevating the limb above the heart for the first 2 days to minimize swelling and applying warmth after 48 hours to relieve pain and speed healing.

Rating: 4 (The metric is followed mostly)
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Actionable Insights and Business Recommendations</h2></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">1. <strong>Enhance Contextual Relevance:</strong> Increase the chunk_overlap parameter in the retriever to improve result relevance. Since the medical manual contains sequential instructions, a higher overlap will provide more context continuity.<br><br>2. <strong>Maintain High Groundedness:</strong> The model achieved a full score in groundedness due to strict prompting.<br><br>3. <strong>Optimize Embeddings for Domain-Specific Accuracy:</strong> While the current embedding model performs well, switching to a model pre-trained on medical datasets can further improve document retrieval relevance.<br><br>4. <strong>Continuous Knowledge Update:</strong> Regularly update the knowledge base to include the latest medical research and guidelines, ensuring the chatbot remains accurate and relevant.  <br><br>5. <strong>Expand to Multilingual Support:</strong> Implement multilingual capabilities to cater to a diverse group of medical professionals in different regions.  <br><br>6. <strong>Feedback Integration:</strong> Incorporate a feedback mechanism for doctors to refine the chatbot‚Äôs responses and adapt to real-world medical scenarios effectively.  <br><br>7. <strong>Scalability for Other Specializations:</strong> Expand the RAG system to support additional medical specialties, broadening its utility across the healthcare ecosystem.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><font size=6 color='blue'>Power Ahead</font><br>___</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h1>Task</h1><br>Resolve the <code>subprocess-exited-with-error</code> during the installation of libraries to successfully install <code>langchain</code> and its dependencies.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>upgrade_pip</h2><br><br><h3>Subtask:</h3><br>Upgrade pip to its latest version to improve dependency resolution.<br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><strong>Reasoning</strong>:<br>The subtask is to upgrade pip. This command will perform the upgrade.<br><br></div>
            </div>
        </div>
    </div>
    <footer class="export-footer">
        Exported with <a href="https://www.runcell.dev/tool/ipynb-to-html">runcell</a> ‚Äî convert notebooks to HTML or PDF anytime at runcell.dev.
    </footer>
</body>
</html>